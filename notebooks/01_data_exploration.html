<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>01_data_exploration.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>01 data exploration</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-DUlb-6KU.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Combination-CJczP3q7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/menu-items-CKlDAcIy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Cn3C5h2V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/select-E33nSIDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/multi-map-CMSc8wqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dropdown-menu-k3cvSs56.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-QlUG_0sW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utils-BPcfRUDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ai-model-dropdown-BuNmF2aO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/badge-DrRlgkPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/config-DOzlN8_n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNonce-CElEIK4R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-CAMtfgeb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/kbd-BEZA_QXE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/renderShortcut-Cp1zXREV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEvent-mw3fc-le.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeleteCell-yV4YK-xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lazy-NLnLn6Pi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-D-ie3mwB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/precisionRound-JPbfj2M2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-DzEPn_Ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vega-loader.browser-BJKnSXO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-CyyA9NKX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-dialog-DkIHCxse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dialog-DZWinI5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDebounce-Dc646H0x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/numbers-BrVMv_xq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/SSRProvider-3gFeNiun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/context-By5V2JVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNumberFormatter-BFHkt56k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/usePress-CqxmpITG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/input-lkQFhlrZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ImperativeModal-kroC_7ut.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cell-link-CGc-QK-U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-DZiaW65G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/links-Cd3tV5IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/state-dWjslxDZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/MarimoErrorOutput-CkZl2oHu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spinner-CM1AwwT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/strings-jhyl_xMu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/command-CgWi9W7A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/popover-ieUH9gue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useRunCells-DSf9mKXo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-zuiMeyCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-icon-DFLZbTfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mode-BAOMKXFj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/purify.es-BNe8OHFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/RenderHTML-DII6L-pL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-Ny605LgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tabs-DvBunSCS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAsyncData-BIQYiPhO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useIframeCapabilities-CRfeZulz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/error-banner-B98iBZZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/formats-Dmio8FVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useTheme-Dsb69ewj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/en-US-Cok_jNd9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isValid-BhOWABEg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/maps-B9m998ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shim-DuR5ZJNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-C81Fxkfa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/extends-BADOB1Xm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/emotion-is-prop-valid.esm-DY_d0mBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDateFormatter-DHQNk42q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-bwodJiCi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/name-cell-input-kfZkR5qv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useHotkey-VwOksnmL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-B1wJF59y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4dFcbt8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CzaCAuEN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CrvuMM2L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DZAt7AHl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Bu5OuYeo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist--8e9VGsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-SXxUBTmG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D84pVwY7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CXTAKsYC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BUfDRi87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CJIkd1DM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D5QNAo1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/apl-CAJ5Afpm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asciiarmor-B3glo3Hy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asn1-iaUkdUJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/brainfuck-C1Bv_mwK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clike-BEDWkorR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clojure-g07QXTjj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cmake-DnTqIimN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cobol-BKtG7u9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/coffeescript-D5EX_wGl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/commonlisp-QBdsjaTi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/crystal-B0kV858U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/css-lnqtDlV_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cypher-B_ciRc6O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/d-sGSUUdz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/diff-okFUO1eS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dtd-Covqp7FW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dylan-Bf_wFnkY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ecl-BON4bJzJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eiffel-CWbinnR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/elm-DKVclpIr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/erlang-D7Lapqoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/simple-mode-NsCUKpko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/factor-B2ESt4eh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/forth-CCfEYbe1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/fortran-ph1UcBiZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gas-BwHh1zIK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gherkin-a-S-92sq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/groovy-W6xB3OYy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haskell-DCE9UteQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haxe-CLcQehNU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/idl-VKcM9gU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/javascript-3wn7R2v8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mllike-BBifUJsv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/nsis-z1VCt9tx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pug-CaaLw7eE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/python-Dt99D71K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-BJLcBgU0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/objectWithoutPropertiesLoose-BhduYW5j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-DXZXojh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-C8_hvhi2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BwPQWTZk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/icons-DVWpV4I_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-missing-import-CgnlhMvv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/blob-BgGJeXvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-cell-with-ai-B5g8vtHB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-function-C7Ij9TAd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spec-D64rpvwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/focus-Bg0Cm8D6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useInstallPackage-CX-LUKF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/column-preview-CEDUFvMb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAddCell-C5hu4Wun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toggle-6a-IWcUo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/api-B8WZp3pa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globals-DlvGFwxH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/share-Cyx6Ke3B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4J1GeSh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utilities.esm-BUZA9ZNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/floating-outline-DJ1FXuVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eye-off-DNEZNQI7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/plus-VNKMcdhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/readonly-python-code-B1LohqR_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-video-camera-Bt4f7oOT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-text-KeEJTZsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-DU2hKpP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-CKcqkReK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/label-BnC8-64i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-x7Qa7Rrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textarea-faXBMy_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-ccw-Dmg0YI4-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-2-BsccpX3E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-CAATHPdC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/field-D6TVJZGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/switch-DBfU9QHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useBoolean-Do2iSPXV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeepCompareMemoize-DVzR9zu0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/LazyAnyLanguageCodeMirror-C5EeHVjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-BfF9hgo8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/prop-types-DVt2dPhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/es-Bve1w9dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/VisuallyHidden-BhVlvbgE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globe-DW6c4--m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/send-DjnZs47z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-cw-z53rVhjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/settings-Dt7V2Blo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/triangle-alert-DoSv9yQr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/bundle.esm-CC-LjhS-.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-CYOH-TAt.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "01_data_exploration.py",
            "mode": "read",
            "version": "0.17.8",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": false, "show_output": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "\"\"\"Setup path and import core libraries.\"\"\"\nimport sys\nfrom pathlib import Path\n# Add project root to path (works for both notebook and exported script)\ntry:\n    _file_path = Path(__file__).resolve()\nexcept NameError:\n    _file_path = Path.cwd() / \"notebooks\" / \"01_data_exploration.py\"\n_project_root = _file_path.parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\nimport marimo as mo\nimport pandas as pd\nimport numpy as np\nfrom typing import Optional, List, Dict, Tuple\nimport json\nimport logging\nfrom src.config import DEMO_MODE_ENABLED\n\nlogger = logging.getLogger(__name__)", "code_hash": "e7c8261f595c6044cfdf2fa9c2f21f7c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "__"}, {"code": "\"\"\"\n## Step 0: Scope \u0026 Framing\n\n**ABCA4 and Stargardt Disease**\n\nABCA4 (ATP Binding Cassette Transporter A4) is an ATP-dependent lipid transporter crucial for photoreceptor function.\nPathogenic variants in ABCA4 cause Stargardt disease (STGD1), a progressive macular degeneration leading to\nblindness. Over 3,500 known ABCA4 variants exist, many classified as Uncertain Significance (VUS).\n\n**The v1 Question**\n\nGiven rare ABCA4 variants (VUS or conflicting), how can we select K=20\u201350 variants for high-throughput MPRAssay,\ncombining:\n- Computational pathogenicity predictions (AlphaMissense, SpliceAI, conservation)\n- Domain disruption analysis\n- Allele frequency / gnomAD background\n- Experimental priors (known pathogenic patterns, assay scalability)\n\n**Campaign Goal**\n\nRank and select a diverse, high-confidence subset of variants to advance toward experimental validation.\n\"\"\"\nmo.md(__doc__)", "code_hash": "cde6ef47eff35cea3c91cebc6f409fd0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "__"}, {"code": "\"\"\"Define campaign root paths.\"\"\"\nfrom src.config import (\n    CAMPAIGN_ROOT, DATA_RAW_DIR, DATA_PROCESSED_DIR,\n    ANNOTATIONS_DIR, FEATURES_DIR, validate_file_exists\n)\n\n# Additional paths specific to this notebook\nVARIANTS_DIR = DATA_PROCESSED_DIR / \"variants\"\n\n# Ensure directories exist\nfor d in [DATA_RAW_DIR, VARIANTS_DIR, ANNOTATIONS_DIR, FEATURES_DIR]:\n    d.mkdir(parents=True, exist_ok=True)\n", "code_hash": "a37734195a8e97b31bfbfda5c6b4de20", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "__"}, {"code": "\"\"\"Smoke test: Validate required directories and data availability.\"\"\"\nimport os\n\n# Check directories\nrequired_dirs = [DATA_RAW_DIR, DATA_PROCESSED_DIR]\nmissing_dirs = [d for d in required_dirs if not d.exists()]\n\nif missing_dirs:\n    mo.md(f\"**Error:** Missing required directories: {missing_dirs}\")\nelse:\n    # Check for raw data files\n    raw_files = list(DATA_RAW_DIR.glob(\"**/*.vcf.gz\")) + list(DATA_RAW_DIR.glob(\"**/*.tsv\"))\n    if not raw_files:\n        mo.md(\"**Warning:** No raw data files found in data_raw/. This notebook may not function properly.\")\n    else:\n        mo.md(\"\u2705 Environment validation passed\")", "code_hash": "fbc0578dedd33d3b00b67a4d45d40757", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "__"}, {"code": "\"\"\"\n## Step 0: Configuration Parameters\n\nConfigure defaults for gene, transcript, K, and narratives. These bind downstream cells automatically.\n\"\"\"\nmo.md(__doc__)\n\n# Gene and transcript parameters\ngene_symbol = mo.ui.text(value=\"ABCA4\", label=\"Gene Symbol\", disabled=False)\ntranscript_id = mo.ui.text(value=\"ENST00000370225\", label=\"Canonical Transcript\", disabled=False)\n\n# Optimization parameters\nk_variants = mo.ui.slider(10, 200, value=30, label=\"Panel Size (K variants to select)\")\nbudget_narrative = mo.ui.text_area(\n    value=\"High-throughput MPRAssay validation with focus on Stargardt disease pathogenicity\",\n    label=\"Budget/Narrative\",\n)", "code_hash": "a22d82e7a11d8e4a214e887013387360", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "__"}, {"code": "\"\"\"Display current configuration.\"\"\"\nconfig_display = mo.md(f\"\"\"\n### Current Configuration\n\n- **Gene:** {gene_symbol.value}\n- **Transcript:** {transcript_id.value}\n- **Panel Size (K):** {k_variants.value}\n- **Narrative:** {budget_narrative.value[:80]}...\n\nAll downstream cells use these parameters automatically.\n\"\"\")", "code_hash": "218c25e709b43cbe4b90dd98c914e00e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "__"}, {"code": "\"\"\"\n## Step 1: Data Ingest\n\n### Available Data Sources\n\n- **ClinVar Variants** (data_raw/clinvar/)\n- **gnomAD Frequencies** (data_raw/gnomad/)\n- **SpliceAI Predictions** (data_raw/spliceai/)\n- **AlphaMissense Scores** (data_raw/alphamissense/)\n\nUpload an optional TSV file with additional variants, or use the downloaded data as-is.\n\"\"\"\nmo.md(__doc__)", "code_hash": "4f43db061db2679d3035660cd2b4b516", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "__"}, {"code": "\"\"\"Optional TSV Upload.\"\"\"\nuploaded_file = mo.ui.file_browser(filetypes=[\".tsv\", \".csv\", \".txt\"], label=\"Upload Partner Data (Optional)\")", "code_hash": "601d89ab8ce080e9521c56832933c99b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "__"}, {"code": "\"\"\"\nLoad ABCA4 variants using the authoritative filter_abca4_variants.py pipeline.\n\nThis cell invokes the real data processing pipeline rather than truncating TSV\nor creating synthetic rows.\n\"\"\"\nsys.path.insert(0, str(CAMPAIGN_ROOT))\nfrom src.data.filter_abca4_variants import ABCA4VariantFilter\n\nvariants_source = \"unknown\"\n\ntry:\n    # Check if we have cached filtered variants\n    cached_path = VARIANTS_DIR / \"abca4_clinvar_vus.parquet\"\n    if cached_path.exists():\n        logger.info(f\"Loading cached variants from {cached_path}\")\n        df_variants_raw = pd.read_parquet(cached_path)\n        logger.info(f\"Loaded {len(df_variants_raw)} cached variants\")\n        variants_source = \"cache\"\n    else:\n        # Run the authoritative filter pipeline\n        logger.info(\"Running authoritative ABCA4 variant filtering pipeline...\")\n        filter_engine = ABCA4VariantFilter(input_dir=DATA_RAW_DIR, output_dir=VARIANTS_DIR)\n        filter_success = filter_engine.run()\n\n        if filter_success:\n            df_variants_raw = pd.read_parquet(cached_path)\n            logger.info(f\"Loaded {len(df_variants_raw)} filtered variants from pipeline\")\n            variants_source = \"pipeline\"\n        else:\n            logger.error(\"Variant filtering pipeline failed\")\n            df_variants_raw = pd.DataFrame()\n\nexcept Exception as e:\n    logger.error(f\"Failed to run variant filter: {e}\")\n    if DEMO_MODE_ENABLED:\n        logger.info(\"Demo mode: Using synthetic example data\")\n        # Demo: Create example data for testing\n        df_variants_raw = pd.DataFrame({\n            \"chrom\": [\"1\"] * 10,\n            \"pos\": range(94400000, 94400010),\n            \"ref\": [\"A\"] * 10,\n            \"alt\": [\"T\", \"G\", \"C\"] * 3 + [\"T\"],\n            \"clinical_significance\": [\"Uncertain significance\"] * 10,\n            \"gene_symbol\": [\"ABCA4\"] * 10,\n        })\n        variants_source = \"demo\"\n    else:\n        logger.error(\"Data loading failed. Enable DEMO_MODE_ENABLED in src/config.py for synthetic data, or check data_raw/ directory.\")\n        df_variants_raw = pd.DataFrame()\n        variants_source = \"error\"\n\n# Load uploaded TSV if provided (append to existing data)\nif uploaded_file is not None and hasattr(uploaded_file, 'value') and uploaded_file.value:\n    logger.info(f\"Loading uploaded file\")\n    try:\n        df_uploaded = pd.read_csv(uploaded_file.value, sep=\"\\t\", dtype=str)\n        df_variants_raw = pd.concat([df_variants_raw, df_uploaded], ignore_index=True, sort=False)\n        # Deduplicate by chrom, pos, ref, alt\n        cols_for_dedup = [\"chrom\", \"pos\", \"ref\", \"alt\"]\n        if all(c in df_variants_raw.columns for c in cols_for_dedup):\n            df_variants_raw = df_variants_raw.drop_duplicates(subset=cols_for_dedup, keep=\"first\")\n        logger.info(f\"  Loaded {len(df_uploaded)} variants from uploaded file, now {len(df_variants_raw)} total\")\n        variants_source = f\"{variants_source}+upload\" if variants_source else \"upload\"\n    except Exception as e:\n        logger.error(f\"Failed to load uploaded file: {e}\")\n\nlogger.info(f\"Total unique variants: {len(df_variants_raw)}\")\ndf_variants_raw.attrs['source'] = variants_source or \"unknown\"\n", "code_hash": "121b724f3cb2528e095ba61e300ab016", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "__"}, {"code": "\"\"\"Display data snapshot after loading variants.\"\"\"\nif not df_variants_raw.empty:\n    mo.md(\"### Data Snapshot\")\n\n    # Display shape\n    mo.md(f\"**Dataset Shape:** {df_variants_raw.shape[0]} rows \u00d7 {df_variants_raw.shape[1]} columns\")\n\n    # Display column dtypes\n    schema_df = pd.DataFrame({\n        \"column\": df_variants_raw.columns,\n        \"dtype\": df_variants_raw.dtypes.astype(str)\n    })\n    mo.md(\"**Column Data Types:**\")\n    mo.ui.table(schema_df.reset_index(drop=True), show_data_types=False)\n\n    # Display head(3)\n    mo.md(\"**Sample Data (first 3 rows):**\")\n    mo.ui.table(df_variants_raw.head(3), show_data_types=True)", "code_hash": "04b7fb2f48cd39e96d40894a422b55d1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "__"}, {"code": "\"\"\"Report how variants were loaded (cache vs pipeline).\"\"\"\nvariant_source = df_variants_raw.attrs.get('source', 'unknown')\nmo.md(f\"\"\"\n**Variant source:** `{variant_source}`\n\nCached parquet loads are instant. If the notebook re-ran the ClinVar pipeline you'll see `pipeline` here.\n\"\"\")", "code_hash": "fbbaacc24a3df915d95202c2f16e77ea", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "__"}, {"code": "\"\"\"Display raw variant counts by clinical significance.\"\"\"\nif df_variants_raw.empty:\n    mo.md(\"No variants loaded.\")\nelse:\n    # Find clinical significance column\n    _clinsig_cols = [c for c in df_variants_raw.columns if \"clin\" in c.lower() or \"significance\" in c.lower()]\n    _clinsig_col = _clinsig_cols[0] if _clinsig_cols else \"clinical_significance\"\n\n    if _clinsig_col in df_variants_raw.columns:\n        _clinsig_summary = df_variants_raw[_clinsig_col].value_counts().to_frame(\"count\")\n        mo.md(f\"\"\"\n### Raw Variant Summary\n\n**Total variants:** {len(df_variants_raw)}\n\n**Distribution by Clinical Significance:**\n\"\"\")\n        mo.ui.table(_clinsig_summary.reset_index())\n    else:\n        mo.md(f\"**Total variants:** {len(df_variants_raw)}\")", "code_hash": "f2e7b538163659839541d0971ddf63e1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "__"}, {"code": "\"\"\"Interactive Filtering panel.\"\"\"\nmo.md(\"\"\"\n### Interactive Filtering\n\nUse controls below to filter variants.\n\"\"\")\n\nfilter_clinsig = None\nfilter_af = None\n\nif not df_variants_raw.empty:\n    # Find clinical significance column\n    _clinsig_cols = [c for c in df_variants_raw.columns if \"clin\" in c.lower() or \"significance\" in c.lower()]\n    _clinsig_col = _clinsig_cols[0] if _clinsig_cols else None\n\n    if _clinsig_col:\n        _clinsig_options = df_variants_raw[_clinsig_col].dropna().unique().tolist()\n        filter_clinsig = mo.ui.multiselect(\n            options=sorted(_clinsig_options),\n            value=sorted(_clinsig_options),\n            label=\"Clinical Significance\"\n        )\n\n    # Optional: allele frequency filter\n    filter_af = mo.ui.slider(0.0, 0.01, value=0.01, step=0.0001, label=\"Max gnomAD AF (if available)\")", "code_hash": "483dc97b9425e88c5699b0dee8f002ec", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "__"}, {"code": "\"\"\"Apply filters to get working variant set.\"\"\"\ndf_variants_filtered = df_variants_raw.copy()\n\n# Filter by clinical significance\nif filter_clinsig is not None and hasattr(filter_clinsig, 'value'):\n    _clinsig_cols = [c for c in df_variants_filtered.columns if \"clin\" in c.lower() or \"significance\" in c.lower()]\n    _clinsig_col = _clinsig_cols[0] if _clinsig_cols else None\n    if _clinsig_col and _clinsig_col in df_variants_filtered.columns:\n        df_variants_filtered = df_variants_filtered[df_variants_filtered[_clinsig_col].isin(filter_clinsig.value)]\n\n# Filter by AF if gnomad_af column exists\nif filter_af is not None and \"gnomad_af\" in df_variants_filtered.columns and hasattr(filter_af, 'value'):\n    df_variants_filtered = df_variants_filtered[df_variants_filtered[\"gnomad_af\"] \u003C= filter_af.value]", "code_hash": "771b22236d7b917e41a2bb901f3d402b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "__"}, {"code": "\"\"\"Display filtered variant count.\"\"\"\nmo.md(f\"\"\"\n### Filtered Variants: {len(df_variants_filtered)} variants\n\nReady for annotation and feature engineering.\n\"\"\")", "code_hash": "01f4b718f572a9acb4a0fe0212a0ea5c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "__"}, {"code": "\"\"\"\n## Step 2: Annotation \u0026 Deterministic Features\n\nAdd VEP annotations, gnomAD joins, conservation scores, and domain mappings.\n\"\"\"\nmo.md(__doc__)", "code_hash": "9755a9453ec74bc573c4891915b571b5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "__"}, {"code": "\"\"\"\nAdd transcript annotations using the authoritative annotate_transcripts.py pipeline.\n\nThis cell invokes VEP and pyensembl APIs for real transcript/consequence annotations\nrather than using placeholder values.\n\"\"\"\nsys.path.insert(0, str(CAMPAIGN_ROOT))\nfrom src.annotation.annotate_transcripts import VariantAnnotator\n\nannotation_source = \"unknown\"\n\ntry:\n    # Check if we have cached annotated variants\n    cached_annot_path = ANNOTATIONS_DIR / \"abca4_vus_annotated.parquet\"\n    if cached_annot_path.exists():\n        logger.info(f\"Loading cached annotations from {cached_annot_path}\")\n        df_annot = pd.read_parquet(cached_annot_path)\n        logger.info(f\"Loaded {len(df_annot)} cached annotated variants\")\n        annotation_source = \"cache\"\n    else:\n        # Run the authoritative annotation pipeline\n        logger.info(\"Running authoritative variant annotation pipeline...\")\n\n        # First, save filtered variants to the expected location\n        temp_path = VARIANTS_DIR / \"abca4_clinvar_vus.parquet\"\n        df_variants_filtered.to_parquet(temp_path)\n\n        annotator = VariantAnnotator(input_dir=VARIANTS_DIR, output_dir=ANNOTATIONS_DIR)\n        annotation_success = annotator.run()\n\n        if annotation_success:\n            df_annot = pd.read_parquet(cached_annot_path)\n            logger.info(f\"Loaded {len(df_annot)} annotated variants from pipeline\")\n            annotation_source = \"pipeline\"\n        else:\n            if DEMO_MODE_ENABLED:\n                logger.warning(\"Annotation pipeline failed; using minimal demo annotations\")\n            df_annot = df_variants_filtered.copy()\n                # Add minimal demo columns\n            for col in [\"transcript_id\", \"vep_consequence\", \"vep_impact\", \"genomic_region\"]:\n                if col not in df_annot.columns:\n                    df_annot[col] = None\n                annotation_source = \"demo\"\n            else:\n                logger.error(\"Annotation pipeline failed. Enable DEMO_MODE_ENABLED in src/config.py for demo data.\")\n                df_annot = pd.DataFrame()\n                annotation_source = \"error\"\n\nexcept Exception as e:\n    logger.error(f\"Failed to run annotation pipeline: {e}\")\n    if DEMO_MODE_ENABLED:\n        logger.info(\"Demo mode: Using minimal fallback annotations\")\n    df_annot = df_variants_filtered.copy()\n        # Add minimal demo columns\n    for col in [\"transcript_id\", \"vep_consequence\", \"vep_impact\", \"genomic_region\"]:\n        if col not in df_annot.columns:\n            df_annot[col] = None\n        annotation_source = \"demo\"\n    else:\n        logger.error(\"Annotation failed. Enable DEMO_MODE_ENABLED in src/config.py for demo data.\")\n        df_annot = pd.DataFrame()\n        annotation_source = \"error\"\n\nlogger.info(f\"Annotation complete. Ready for feature engineering.\")\ndf_annot.attrs['source'] = annotation_source", "code_hash": "f92bedf99fc4ef281b6adb835beda8d8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "__"}, {"code": "\"\"\"Show annotation data provenance.\"\"\"\nannot_source = df_annot.attrs.get('source', 'unknown')\nmo.md(f\"\"\"\n**Annotation source:** `{annot_source}`\n\nCached annotations skip pyensembl/VEPlac calls; `pipeline` indicates this run hit the Ensembl APIs.\n\"\"\")", "code_hash": "f195f4b773305290c17e2f3dd950cef9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "__"}, {"code": "\"\"\"Display consequence distribution.\"\"\"\nif \"consequence\" in df_annot.columns and not df_annot.empty:\n    _consequence_counts = df_annot[\"consequence\"].value_counts().to_frame(\"count\")\n    mo.md(\"\"\"\n### Consequence Distribution\n\"\"\")\n    mo.ui.table(_consequence_counts.head(10).reset_index())\nelse:\n    mo.md(\"No consequence data available.\")", "code_hash": "d783eb4c33e5ad0759c1511ca3e54013", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "__"}, {"code": "\"\"\"\nPass annotated variants forward.\n\nDetailed feature engineering (gnomAD, conservation, regulatory, domains)\nhappens in the next notebook (02_feature_engineering.py) which calls:\n- campaigns/abca4/src/features/regulatory.py (gnomAD + domain mapping)\n- campaigns/abca4/src/features/conservation.py (phyloP/phastCons)\n- campaigns/abca4/src/features/missense.py (AlphaMissense scores)\n- campaigns/abca4/src/features/splice.py (SpliceAI scores)\n\"\"\"\ndf_domains = df_annot.copy()", "code_hash": "52aebc93a119d27a8e462cd105b4f7bf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "__"}, {"code": "\"\"\"Note about domain distribution.\"\"\"\nmo.md(\"\"\"\n### Domain Annotation\n\nDomain mapping and regulatory features will be added in the next notebook\n(02_feature_engineering.py) using the authoritative domain configuration\nand gnomAD data.\n\"\"\")", "code_hash": "cde9a987c34c7537ad175c06ab0b2b04", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "__"}, {"code": "\"\"\"Display completeness metrics.\"\"\"\n_key_cols = [\n    \"chrom\", \"pos\", \"ref\", \"alt\", \"clinical_significance\",\n    \"consequence\", \"gnomad_af\", \"phylop_score\", \"domain\"\n]\n_completeness = {}\nfor _col in _key_cols:\n    if _col in df_domains.columns:\n        _completeness[_col] = df_domains[_col].notna().sum() / len(df_domains) if len(df_domains) \u003E 0 else 0.0\n    else:\n        _completeness[_col] = 0.0\n\n_comp_df = pd.DataFrame(\n    [(k, f\"{v:.1%}\") for k, v in _completeness.items()],\n    columns=[\"Field\", \"Completeness\"]\n)\n\nmo.md(\"\"\"\n### Annotation Completeness\n\nKey fields completeness check:\n\"\"\")\nmo.ui.table(_comp_df)", "code_hash": "815297dee6617cd5a79cc345505d2e9c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "__"}, {"code": "\"\"\"Export annotated variants to disk.\"\"\"\nfrom src.config import get_annotated_variants_path\noutput_path_annot = get_annotated_variants_path()\ndf_domains.to_parquet(output_path_annot)\nlogger.info(f\"Wrote annotated variants to {output_path_annot}\")", "code_hash": "dea9be595993fbb59f590dbd9d7c42b0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "__"}, {"code": "\"\"\"Confirm export.\"\"\"\nmo.md(f\"\"\"\n**Annotation Complete**\n\nSaved to: `{output_path_annot}`\n\n**Next Step:** Open `02_feature_engineering.py` to add model scores and construct impact metrics.\n\"\"\")", "code_hash": "daf0ae6fa5f037017a53052bed8c4a4b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "__"}, {"code": "\"\"\"Tie this notebook back to the v1 plan.\"\"\"\nmo.md(\"\"\"\n### Plan Alignment\n\n- **Step\u202f1 \u2013 Data ingest (ClinVar + partner variants):** Completed above via `filter_abca4_variants.py`, outputs now cached under `data_processed/variants/`.\n- **Step\u202f2 \u2013 Annotation \u0026 deterministic features:** Completed via `annotate_transcripts.py` (VEP/pyensembl). The resulting `variants_annotated.parquet` is the hand-off into feature engineering.\n\nThis notebook is now the authoritative entry point for Steps\u202f0\u20112 of the ABCA4 v1 pipeline.\n\"\"\")", "code_hash": "901cd0615ce7f5df0c6e9d10d491a6c0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "__"}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e7c8261f595c6044cfdf2fa9c2f21f7c", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cde6ef47eff35cea3c91cebc6f409fd0", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"step-0-scope-framing\"\u003EStep 0: Scope \u0026amp; Framing\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EABCA4 and Stargardt Disease\u003C/strong\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EABCA4 (ATP Binding Cassette Transporter A4) is an ATP-dependent lipid transporter crucial for photoreceptor function.\nPathogenic variants in ABCA4 cause Stargardt disease (STGD1), a progressive macular degeneration leading to\nblindness. Over 3,500 known ABCA4 variants exist, many classified as Uncertain Significance (VUS).\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EThe v1 Question\u003C/strong\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EGiven rare ABCA4 variants (VUS or conflicting), how can we select K=20\u201350 variants for high-throughput MPRAssay,\ncombining:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EComputational pathogenicity predictions (AlphaMissense, SpliceAI, conservation)\u003C/li\u003E\n\u003Cli\u003EDomain disruption analysis\u003C/li\u003E\n\u003Cli\u003EAllele frequency / gnomAD background\u003C/li\u003E\n\u003Cli\u003EExperimental priors (known pathogenic patterns, assay scalability)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ECampaign Goal\u003C/strong\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ERank and select a diverse, high-confidence subset of variants to advance toward experimental validation.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a37734195a8e97b31bfbfda5c6b4de20", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fbc0578dedd33d3b00b67a4d45d40757", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a22d82e7a11d8e4a214e887013387360", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "218c25e709b43cbe4b90dd98c914e00e", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4f43db061db2679d3035660cd2b4b516", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"step-1-data-ingest\"\u003EStep 1: Data Ingest\u003C/h2\u003E\n\u003Ch3 id=\"available-data-sources\"\u003EAvailable Data Sources\u003C/h3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EClinVar Variants\u003C/strong\u003E (data_raw/clinvar/)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EgnomAD Frequencies\u003C/strong\u003E (data_raw/gnomad/)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ESpliceAI Predictions\u003C/strong\u003E (data_raw/spliceai/)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EAlphaMissense Scores\u003C/strong\u003E (data_raw/alphamissense/)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EUpload an optional TSV file with additional variants, or use the downloaded data as-is.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "601d89ab8ce080e9521c56832933c99b", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "121b724f3cb2528e095ba61e300ab016", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "2025-11-17 20:12:02,448 - INFO - Loading cached variants from /Users/sethmorton/Desktop/codingplayground/abca4/data_processed/variants/abca4_clinvar_vus.parquet\n2025-11-17 20:12:02,520 - INFO - Loaded 0 cached variants\n2025-11-17 20:12:02,520 - INFO - Total unique variants: 0\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "04b7fb2f48cd39e96d40894a422b55d1", "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fbbaacc24a3df915d95202c2f16e77ea", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EVariant source:\u003C/strong\u003E \u003Ccode\u003Ecache\u003C/code\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ECached parquet loads are instant. If the notebook re-ran the ClinVar pipeline you'll see \u003Ccode\u003Epipeline\u003C/code\u003E here.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f2e7b538163659839541d0971ddf63e1", "console": [], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "483dc97b9425e88c5699b0dee8f002ec", "console": [], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "771b22236d7b917e41a2bb901f3d402b", "console": [], "id": "nWHF", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "01f4b718f572a9acb4a0fe0212a0ea5c", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"filtered-variants-0-variants\"\u003EFiltered Variants: 0 variants\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EReady for annotation and feature engineering.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "9755a9453ec74bc573c4891915b571b5", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"step-2-annotation-deterministic-features\"\u003EStep 2: Annotation \u0026amp; Deterministic Features\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAdd VEP annotations, gnomAD joins, conservation scores, and domain mappings.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f92bedf99fc4ef281b6adb835beda8d8", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "2025-11-17 20:12:02,641 - INFO - Loading cached annotations from /Users/sethmorton/Desktop/codingplayground/abca4/data_processed/annotations/abca4_vus_annotated.parquet\n2025-11-17 20:12:02,642 - INFO - Loaded 0 cached annotated variants\n2025-11-17 20:12:02,642 - INFO - Annotation complete. Ready for feature engineering.\n", "type": "stream"}], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f195f4b773305290c17e2f3dd950cef9", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EAnnotation source:\u003C/strong\u003E \u003Ccode\u003Ecache\u003C/code\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ECached annotations skip pyensembl/VEPlac calls; \u003Ccode\u003Epipeline\u003C/code\u003E indicates this run hit the Ensembl APIs.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d783eb4c33e5ad0759c1511ca3e54013", "console": [], "id": "TqIu", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "52aebc93a119d27a8e462cd105b4f7bf", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cde9a987c34c7537ad175c06ab0b2b04", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"domain-annotation\"\u003EDomain Annotation\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EDomain mapping and regulatory features will be added in the next notebook\n(02_feature_engineering.py) using the authoritative domain configuration\nand gnomAD data.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "815297dee6617cd5a79cc345505d2e9c", "console": [], "id": "ulZA", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='ulZA-0' random-id='677bda36-43f7-9551-fbfd-907fec11e60b'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;chrom\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pos\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ref\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;alt\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:4,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;clinical_significance\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;consequence\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;gnomad_af\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:7,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;phylop_score\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;_marimo_row_id\u0026#92;\u0026quot;:8,\u0026#92;\u0026quot;Field\u0026#92;\u0026quot;:\u0026#92;\u0026quot;domain\u0026#92;\u0026quot;,\u0026#92;\u0026quot;Completeness\u0026#92;\u0026quot;:\u0026#92;\u0026quot;0.0%\u0026#92;\u0026quot;}]\u0026quot;' data-total-rows='9' data-total-columns='2' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='false' data-page-size='10' data-field-types='[[\u0026quot;Field\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;object\u0026quot;]],[\u0026quot;Completeness\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;object\u0026quot;]]]' data-selection='\u0026quot;multi\u0026quot;' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='true' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "dea9be595993fbb59f590dbd9d7c42b0", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "2025-11-17 20:12:02,664 - INFO - Wrote annotated variants to /Users/sethmorton/Desktop/codingplayground/abca4/data_processed/annotations/abca4_vus_annotated.parquet\n", "type": "stream"}], "id": "ecfG", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "daf0ae6fa5f037017a53052bed8c4a4b", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EAnnotation Complete\u003C/strong\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ESaved to: \u003Ccode\u003E/Users/sethmorton/Desktop/codingplayground/abca4/data_processed/annotations/abca4_vus_annotated.parquet\u003C/code\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ENext Step:\u003C/strong\u003E Open \u003Ccode\u003E02_feature_engineering.py\u003C/code\u003E to add model scores and construct impact metrics.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "901cd0615ce7f5df0c6e9d10d491a6c0", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"plan-alignment\"\u003EPlan Alignment\u003C/h3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EStep\u202f1 \u2013 Data ingest (ClinVar + partner variants):\u003C/strong\u003E Completed above via \u003Ccode\u003Efilter_abca4_variants.py\u003C/code\u003E, outputs now cached under \u003Ccode\u003Edata_processed/variants/\u003C/code\u003E.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EStep\u202f2 \u2013 Annotation \u0026amp; deterministic features:\u003C/strong\u003E Completed via \u003Ccode\u003Eannotate_transcripts.py\u003C/code\u003E (VEP/pyensembl). The resulting \u003Ccode\u003Evariants_annotated.parquet\u003C/code\u003E is the hand-off into feature engineering.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThis notebook is now the authoritative entry point for Steps\u202f0\u20112 of the ABCA4 v1 pipeline.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.8%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%22%22%22Setup%20path%20and%20import%20core%20libraries.%22%22%22%0A%20%20%20%20import%20sys%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20%23%20Add%20project%20root%20to%20path%20(works%20for%20both%20notebook%20and%20exported%20script)%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path(__file__).resolve()%0A%20%20%20%20except%20NameError%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path.cwd()%20%2F%20%22notebooks%22%20%2F%20%2201_data_exploration.py%22%0A%20%20%20%20_project_root%20%3D%20_file_path.parent.parent%0A%20%20%20%20if%20str(_project_root)%20not%20in%20sys.path%3A%0A%20%20%20%20%20%20%20%20sys.path.insert(0%2C%20str(_project_root))%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20from%20typing%20import%20Optional%2C%20List%2C%20Dict%2C%20Tuple%0A%20%20%20%20import%20json%0A%20%20%20%20import%20logging%0A%20%20%20%20from%20src.config%20import%20DEMO_MODE_ENABLED%0A%0A%20%20%20%20logger%20%3D%20logging.getLogger(__name__)%0A%20%20%20%20return%20DEMO_MODE_ENABLED%2C%20logger%2C%20mo%2C%20pd%2C%20sys%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20%23%23%20Step%200%3A%20Scope%20%26%20Framing%0A%0A%20%20%20%20**ABCA4%20and%20Stargardt%20Disease**%0A%0A%20%20%20%20ABCA4%20(ATP%20Binding%20Cassette%20Transporter%20A4)%20is%20an%20ATP-dependent%20lipid%20transporter%20crucial%20for%20photoreceptor%20function.%0A%20%20%20%20Pathogenic%20variants%20in%20ABCA4%20cause%20Stargardt%20disease%20(STGD1)%2C%20a%20progressive%20macular%20degeneration%20leading%20to%0A%20%20%20%20blindness.%20Over%203%2C500%20known%20ABCA4%20variants%20exist%2C%20many%20classified%20as%20Uncertain%20Significance%20(VUS).%0A%0A%20%20%20%20**The%20v1%20Question**%0A%0A%20%20%20%20Given%20rare%20ABCA4%20variants%20(VUS%20or%20conflicting)%2C%20how%20can%20we%20select%20K%3D20%E2%80%9350%20variants%20for%20high-throughput%20MPRAssay%2C%0A%20%20%20%20combining%3A%0A%20%20%20%20-%20Computational%20pathogenicity%20predictions%20(AlphaMissense%2C%20SpliceAI%2C%20conservation)%0A%20%20%20%20-%20Domain%20disruption%20analysis%0A%20%20%20%20-%20Allele%20frequency%20%2F%20gnomAD%20background%0A%20%20%20%20-%20Experimental%20priors%20(known%20pathogenic%20patterns%2C%20assay%20scalability)%0A%0A%20%20%20%20**Campaign%20Goal**%0A%0A%20%20%20%20Rank%20and%20select%20a%20diverse%2C%20high-confidence%20subset%20of%20variants%20to%20advance%20toward%20experimental%20validation.%0A%20%20%20%20%22%22%22%0A%20%20%20%20mo.md(__doc__)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%22%22%22Define%20campaign%20root%20paths.%22%22%22%0A%20%20%20%20from%20src.config%20import%20(%0A%20%20%20%20%20%20%20%20CAMPAIGN_ROOT%2C%20DATA_RAW_DIR%2C%20DATA_PROCESSED_DIR%2C%0A%20%20%20%20%20%20%20%20ANNOTATIONS_DIR%2C%20FEATURES_DIR%2C%20validate_file_exists%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Additional%20paths%20specific%20to%20this%20notebook%0A%20%20%20%20VARIANTS_DIR%20%3D%20DATA_PROCESSED_DIR%20%2F%20%22variants%22%0A%0A%20%20%20%20%23%20Ensure%20directories%20exist%0A%20%20%20%20for%20d%20in%20%5BDATA_RAW_DIR%2C%20VARIANTS_DIR%2C%20ANNOTATIONS_DIR%2C%20FEATURES_DIR%5D%3A%0A%20%20%20%20%20%20%20%20d.mkdir(parents%3DTrue%2C%20exist_ok%3DTrue)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20ANNOTATIONS_DIR%2C%0A%20%20%20%20%20%20%20%20CAMPAIGN_ROOT%2C%0A%20%20%20%20%20%20%20%20DATA_PROCESSED_DIR%2C%0A%20%20%20%20%20%20%20%20DATA_RAW_DIR%2C%0A%20%20%20%20%20%20%20%20VARIANTS_DIR%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(DATA_PROCESSED_DIR%2C%20DATA_RAW_DIR%2C%20mo)%3A%0A%20%20%20%20%22%22%22Smoke%20test%3A%20Validate%20required%20directories%20and%20data%20availability.%22%22%22%0A%20%20%20%20import%20os%0A%0A%20%20%20%20%23%20Check%20directories%0A%20%20%20%20required_dirs%20%3D%20%5BDATA_RAW_DIR%2C%20DATA_PROCESSED_DIR%5D%0A%20%20%20%20missing_dirs%20%3D%20%5Bd%20for%20d%20in%20required_dirs%20if%20not%20d.exists()%5D%0A%0A%20%20%20%20if%20missing_dirs%3A%0A%20%20%20%20%20%20%20%20mo.md(f%22**Error%3A**%20Missing%20required%20directories%3A%20%7Bmissing_dirs%7D%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Check%20for%20raw%20data%20files%0A%20%20%20%20%20%20%20%20raw_files%20%3D%20list(DATA_RAW_DIR.glob(%22**%2F*.vcf.gz%22))%20%2B%20list(DATA_RAW_DIR.glob(%22**%2F*.tsv%22))%0A%20%20%20%20%20%20%20%20if%20not%20raw_files%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Warning%3A**%20No%20raw%20data%20files%20found%20in%20data_raw%2F.%20This%20notebook%20may%20not%20function%20properly.%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9C%85%20Environment%20validation%20passed%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20%23%23%20Step%200%3A%20Configuration%20Parameters%0A%0A%20%20%20%20Configure%20defaults%20for%20gene%2C%20transcript%2C%20K%2C%20and%20narratives.%20These%20bind%20downstream%20cells%20automatically.%0A%20%20%20%20%22%22%22%0A%20%20%20%20mo.md(__doc__)%0A%0A%20%20%20%20%23%20Gene%20and%20transcript%20parameters%0A%20%20%20%20gene_symbol%20%3D%20mo.ui.text(value%3D%22ABCA4%22%2C%20label%3D%22Gene%20Symbol%22%2C%20disabled%3DFalse)%0A%20%20%20%20transcript_id%20%3D%20mo.ui.text(value%3D%22ENST00000370225%22%2C%20label%3D%22Canonical%20Transcript%22%2C%20disabled%3DFalse)%0A%0A%20%20%20%20%23%20Optimization%20parameters%0A%20%20%20%20k_variants%20%3D%20mo.ui.slider(10%2C%20200%2C%20value%3D30%2C%20label%3D%22Panel%20Size%20(K%20variants%20to%20select)%22)%0A%20%20%20%20budget_narrative%20%3D%20mo.ui.text_area(%0A%20%20%20%20%20%20%20%20value%3D%22High-throughput%20MPRAssay%20validation%20with%20focus%20on%20Stargardt%20disease%20pathogenicity%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Budget%2FNarrative%22%2C%0A%20%20%20%20)%0A%20%20%20%20return%20budget_narrative%2C%20gene_symbol%2C%20k_variants%2C%20transcript_id%0A%0A%0A%40app.cell%0Adef%20_(budget_narrative%2C%20gene_symbol%2C%20k_variants%2C%20mo%2C%20transcript_id)%3A%0A%20%20%20%20%22%22%22Display%20current%20configuration.%22%22%22%0A%20%20%20%20config_display%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20Current%20Configuration%0A%0A%20%20%20%20-%20**Gene%3A**%20%7Bgene_symbol.value%7D%0A%20%20%20%20-%20**Transcript%3A**%20%7Btranscript_id.value%7D%0A%20%20%20%20-%20**Panel%20Size%20(K)%3A**%20%7Bk_variants.value%7D%0A%20%20%20%20-%20**Narrative%3A**%20%7Bbudget_narrative.value%5B%3A80%5D%7D...%0A%0A%20%20%20%20All%20downstream%20cells%20use%20these%20parameters%20automatically.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20%23%23%20Step%201%3A%20Data%20Ingest%0A%0A%20%20%20%20%23%23%23%20Available%20Data%20Sources%0A%0A%20%20%20%20-%20**ClinVar%20Variants**%20(data_raw%2Fclinvar%2F)%0A%20%20%20%20-%20**gnomAD%20Frequencies**%20(data_raw%2Fgnomad%2F)%0A%20%20%20%20-%20**SpliceAI%20Predictions**%20(data_raw%2Fspliceai%2F)%0A%20%20%20%20-%20**AlphaMissense%20Scores**%20(data_raw%2Falphamissense%2F)%0A%0A%20%20%20%20Upload%20an%20optional%20TSV%20file%20with%20additional%20variants%2C%20or%20use%20the%20downloaded%20data%20as-is.%0A%20%20%20%20%22%22%22%0A%20%20%20%20mo.md(__doc__)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22Optional%20TSV%20Upload.%22%22%22%0A%20%20%20%20uploaded_file%20%3D%20mo.ui.file_browser(filetypes%3D%5B%22.tsv%22%2C%20%22.csv%22%2C%20%22.txt%22%5D%2C%20label%3D%22Upload%20Partner%20Data%20(Optional)%22)%0A%20%20%20%20return%20(uploaded_file%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20CAMPAIGN_ROOT%2C%0A%20%20%20%20DATA_RAW_DIR%2C%0A%20%20%20%20DEMO_MODE_ENABLED%2C%0A%20%20%20%20VARIANTS_DIR%2C%0A%20%20%20%20logger%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20sys%2C%0A%20%20%20%20uploaded_file%2C%0A)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20Load%20ABCA4%20variants%20using%20the%20authoritative%20filter_abca4_variants.py%20pipeline.%0A%0A%20%20%20%20This%20cell%20invokes%20the%20real%20data%20processing%20pipeline%20rather%20than%20truncating%20TSV%0A%20%20%20%20or%20creating%20synthetic%20rows.%0A%20%20%20%20%22%22%22%0A%20%20%20%20sys.path.insert(0%2C%20str(CAMPAIGN_ROOT))%0A%20%20%20%20from%20src.data.filter_abca4_variants%20import%20ABCA4VariantFilter%0A%0A%20%20%20%20variants_source%20%3D%20%22unknown%22%0A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%23%20Check%20if%20we%20have%20cached%20filtered%20variants%0A%20%20%20%20%20%20%20%20cached_path%20%3D%20VARIANTS_DIR%20%2F%20%22abca4_clinvar_vus.parquet%22%0A%20%20%20%20%20%20%20%20if%20cached_path.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loading%20cached%20variants%20from%20%7Bcached_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.read_parquet(cached_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_variants_raw)%7D%20cached%20variants%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20variants_source%20%3D%20%22cache%22%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Run%20the%20authoritative%20filter%20pipeline%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(%22Running%20authoritative%20ABCA4%20variant%20filtering%20pipeline...%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_engine%20%3D%20ABCA4VariantFilter(input_dir%3DDATA_RAW_DIR%2C%20output_dir%3DVARIANTS_DIR)%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_success%20%3D%20filter_engine.run()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20filter_success%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.read_parquet(cached_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_variants_raw)%7D%20filtered%20variants%20from%20pipeline%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20variants_source%20%3D%20%22pipeline%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.error(%22Variant%20filtering%20pipeline%20failed%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.DataFrame()%0A%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20logger.error(f%22Failed%20to%20run%20variant%20filter%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20if%20DEMO_MODE_ENABLED%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(%22Demo%20mode%3A%20Using%20synthetic%20example%20data%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Demo%3A%20Create%20example%20data%20for%20testing%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.DataFrame(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22chrom%22%3A%20%5B%221%22%5D%20*%2010%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22pos%22%3A%20range(94400000%2C%2094400010)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22ref%22%3A%20%5B%22A%22%5D%20*%2010%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22alt%22%3A%20%5B%22T%22%2C%20%22G%22%2C%20%22C%22%5D%20*%203%20%2B%20%5B%22T%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22clinical_significance%22%3A%20%5B%22Uncertain%20significance%22%5D%20*%2010%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22gene_symbol%22%3A%20%5B%22ABCA4%22%5D%20*%2010%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20variants_source%20%3D%20%22demo%22%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(%22Data%20loading%20failed.%20Enable%20DEMO_MODE_ENABLED%20in%20src%2Fconfig.py%20for%20synthetic%20data%2C%20or%20check%20data_raw%2F%20directory.%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.DataFrame()%0A%20%20%20%20%20%20%20%20%20%20%20%20variants_source%20%3D%20%22error%22%0A%0A%20%20%20%20%23%20Load%20uploaded%20TSV%20if%20provided%20(append%20to%20existing%20data)%0A%20%20%20%20if%20uploaded_file%20is%20not%20None%20and%20hasattr(uploaded_file%2C%20'value')%20and%20uploaded_file.value%3A%0A%20%20%20%20%20%20%20%20logger.info(f%22Loading%20uploaded%20file%22)%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_uploaded%20%3D%20pd.read_csv(uploaded_file.value%2C%20sep%3D%22%5Ct%22%2C%20dtype%3Dstr)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20pd.concat(%5Bdf_variants_raw%2C%20df_uploaded%5D%2C%20ignore_index%3DTrue%2C%20sort%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Deduplicate%20by%20chrom%2C%20pos%2C%20ref%2C%20alt%0A%20%20%20%20%20%20%20%20%20%20%20%20cols_for_dedup%20%3D%20%5B%22chrom%22%2C%20%22pos%22%2C%20%22ref%22%2C%20%22alt%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20all(c%20in%20df_variants_raw.columns%20for%20c%20in%20cols_for_dedup)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_variants_raw%20%3D%20df_variants_raw.drop_duplicates(subset%3Dcols_for_dedup%2C%20keep%3D%22first%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22%20%20Loaded%20%7Blen(df_uploaded)%7D%20variants%20from%20uploaded%20file%2C%20now%20%7Blen(df_variants_raw)%7D%20total%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20variants_source%20%3D%20f%22%7Bvariants_source%7D%2Bupload%22%20if%20variants_source%20else%20%22upload%22%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Failed%20to%20load%20uploaded%20file%3A%20%7Be%7D%22)%0A%0A%20%20%20%20logger.info(f%22Total%20unique%20variants%3A%20%7Blen(df_variants_raw)%7D%22)%0A%20%20%20%20df_variants_raw.attrs%5B'source'%5D%20%3D%20variants_source%20or%20%22unknown%22%0A%0A%20%20%20%20return%20(df_variants_raw%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_variants_raw%2C%20mo%2C%20pd)%3A%0A%20%20%20%20%22%22%22Display%20data%20snapshot%20after%20loading%20variants.%22%22%22%0A%20%20%20%20if%20not%20df_variants_raw.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Data%20Snapshot%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Display%20shape%0A%20%20%20%20%20%20%20%20mo.md(f%22**Dataset%20Shape%3A**%20%7Bdf_variants_raw.shape%5B0%5D%7D%20rows%20%C3%97%20%7Bdf_variants_raw.shape%5B1%5D%7D%20columns%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Display%20column%20dtypes%0A%20%20%20%20%20%20%20%20schema_df%20%3D%20pd.DataFrame(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22column%22%3A%20df_variants_raw.columns%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22dtype%22%3A%20df_variants_raw.dtypes.astype(str)%0A%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20mo.md(%22**Column%20Data%20Types%3A**%22)%0A%20%20%20%20%20%20%20%20mo.ui.table(schema_df.reset_index(drop%3DTrue)%2C%20show_data_types%3DFalse)%0A%0A%20%20%20%20%20%20%20%20%23%20Display%20head(3)%0A%20%20%20%20%20%20%20%20mo.md(%22**Sample%20Data%20(first%203%20rows)%3A**%22)%0A%20%20%20%20%20%20%20%20mo.ui.table(df_variants_raw.head(3)%2C%20show_data_types%3DTrue)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_variants_raw%2C%20mo)%3A%0A%20%20%20%20%22%22%22Report%20how%20variants%20were%20loaded%20(cache%20vs%20pipeline).%22%22%22%0A%20%20%20%20variant_source%20%3D%20df_variants_raw.attrs.get('source'%2C%20'unknown')%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Variant%20source%3A**%20%60%7Bvariant_source%7D%60%0A%0A%20%20%20%20Cached%20parquet%20loads%20are%20instant.%20If%20the%20notebook%20re-ran%20the%20ClinVar%20pipeline%20you'll%20see%20%60pipeline%60%20here.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_variants_raw%2C%20mo)%3A%0A%20%20%20%20%22%22%22Display%20raw%20variant%20counts%20by%20clinical%20significance.%22%22%22%0A%20%20%20%20if%20df_variants_raw.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20variants%20loaded.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Find%20clinical%20significance%20column%0A%20%20%20%20%20%20%20%20_clinsig_cols%20%3D%20%5Bc%20for%20c%20in%20df_variants_raw.columns%20if%20%22clin%22%20in%20c.lower()%20or%20%22significance%22%20in%20c.lower()%5D%0A%20%20%20%20%20%20%20%20_clinsig_col%20%3D%20_clinsig_cols%5B0%5D%20if%20_clinsig_cols%20else%20%22clinical_significance%22%0A%0A%20%20%20%20%20%20%20%20if%20_clinsig_col%20in%20df_variants_raw.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_clinsig_summary%20%3D%20df_variants_raw%5B_clinsig_col%5D.value_counts().to_frame(%22count%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20Raw%20Variant%20Summary%0A%0A%20%20%20%20**Total%20variants%3A**%20%7Blen(df_variants_raw)%7D%0A%0A%20%20%20%20**Distribution%20by%20Clinical%20Significance%3A**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(_clinsig_summary.reset_index())%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22**Total%20variants%3A**%20%7Blen(df_variants_raw)%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_variants_raw%2C%20mo)%3A%0A%20%20%20%20%22%22%22Interactive%20Filtering%20panel.%22%22%22%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%23%20Interactive%20Filtering%0A%0A%20%20%20%20Use%20controls%20below%20to%20filter%20variants.%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20filter_clinsig%20%3D%20None%0A%20%20%20%20filter_af%20%3D%20None%0A%0A%20%20%20%20if%20not%20df_variants_raw.empty%3A%0A%20%20%20%20%20%20%20%20%23%20Find%20clinical%20significance%20column%0A%20%20%20%20%20%20%20%20_clinsig_cols%20%3D%20%5Bc%20for%20c%20in%20df_variants_raw.columns%20if%20%22clin%22%20in%20c.lower()%20or%20%22significance%22%20in%20c.lower()%5D%0A%20%20%20%20%20%20%20%20_clinsig_col%20%3D%20_clinsig_cols%5B0%5D%20if%20_clinsig_cols%20else%20None%0A%0A%20%20%20%20%20%20%20%20if%20_clinsig_col%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_clinsig_options%20%3D%20df_variants_raw%5B_clinsig_col%5D.dropna().unique().tolist()%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_clinsig%20%3D%20mo.ui.multiselect(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20options%3Dsorted(_clinsig_options)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%3Dsorted(_clinsig_options)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Clinical%20Significance%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Optional%3A%20allele%20frequency%20filter%0A%20%20%20%20%20%20%20%20filter_af%20%3D%20mo.ui.slider(0.0%2C%200.01%2C%20value%3D0.01%2C%20step%3D0.0001%2C%20label%3D%22Max%20gnomAD%20AF%20(if%20available)%22)%0A%20%20%20%20return%20filter_af%2C%20filter_clinsig%0A%0A%0A%40app.cell%0Adef%20_(df_variants_raw%2C%20filter_af%2C%20filter_clinsig)%3A%0A%20%20%20%20%22%22%22Apply%20filters%20to%20get%20working%20variant%20set.%22%22%22%0A%20%20%20%20df_variants_filtered%20%3D%20df_variants_raw.copy()%0A%0A%20%20%20%20%23%20Filter%20by%20clinical%20significance%0A%20%20%20%20if%20filter_clinsig%20is%20not%20None%20and%20hasattr(filter_clinsig%2C%20'value')%3A%0A%20%20%20%20%20%20%20%20_clinsig_cols%20%3D%20%5Bc%20for%20c%20in%20df_variants_filtered.columns%20if%20%22clin%22%20in%20c.lower()%20or%20%22significance%22%20in%20c.lower()%5D%0A%20%20%20%20%20%20%20%20_clinsig_col%20%3D%20_clinsig_cols%5B0%5D%20if%20_clinsig_cols%20else%20None%0A%20%20%20%20%20%20%20%20if%20_clinsig_col%20and%20_clinsig_col%20in%20df_variants_filtered.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_filtered%20%3D%20df_variants_filtered%5Bdf_variants_filtered%5B_clinsig_col%5D.isin(filter_clinsig.value)%5D%0A%0A%20%20%20%20%23%20Filter%20by%20AF%20if%20gnomad_af%20column%20exists%0A%20%20%20%20if%20filter_af%20is%20not%20None%20and%20%22gnomad_af%22%20in%20df_variants_filtered.columns%20and%20hasattr(filter_af%2C%20'value')%3A%0A%20%20%20%20%20%20%20%20df_variants_filtered%20%3D%20df_variants_filtered%5Bdf_variants_filtered%5B%22gnomad_af%22%5D%20%3C%3D%20filter_af.value%5D%0A%20%20%20%20return%20(df_variants_filtered%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_variants_filtered%2C%20mo)%3A%0A%20%20%20%20%22%22%22Display%20filtered%20variant%20count.%22%22%22%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20Filtered%20Variants%3A%20%7Blen(df_variants_filtered)%7D%20variants%0A%0A%20%20%20%20Ready%20for%20annotation%20and%20feature%20engineering.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20%23%23%20Step%202%3A%20Annotation%20%26%20Deterministic%20Features%0A%0A%20%20%20%20Add%20VEP%20annotations%2C%20gnomAD%20joins%2C%20conservation%20scores%2C%20and%20domain%20mappings.%0A%20%20%20%20%22%22%22%0A%20%20%20%20mo.md(__doc__)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20ANNOTATIONS_DIR%2C%0A%20%20%20%20CAMPAIGN_ROOT%2C%0A%20%20%20%20DEMO_MODE_ENABLED%2C%0A%20%20%20%20VARIANTS_DIR%2C%0A%20%20%20%20df_variants_filtered%2C%0A%20%20%20%20logger%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20sys%2C%0A)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20Add%20transcript%20annotations%20using%20the%20authoritative%20annotate_transcripts.py%20pipeline.%0A%0A%20%20%20%20This%20cell%20invokes%20VEP%20and%20pyensembl%20APIs%20for%20real%20transcript%2Fconsequence%20annotations%0A%20%20%20%20rather%20than%20using%20placeholder%20values.%0A%20%20%20%20%22%22%22%0A%20%20%20%20sys.path.insert(0%2C%20str(CAMPAIGN_ROOT))%0A%20%20%20%20from%20src.annotation.annotate_transcripts%20import%20VariantAnnotator%0A%0A%20%20%20%20annotation_source%20%3D%20%22unknown%22%0A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%23%20Check%20if%20we%20have%20cached%20annotated%20variants%0A%20%20%20%20%20%20%20%20cached_annot_path%20%3D%20ANNOTATIONS_DIR%20%2F%20%22abca4_vus_annotated.parquet%22%0A%20%20%20%20%20%20%20%20if%20cached_annot_path.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loading%20cached%20annotations%20from%20%7Bcached_annot_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_annot%20%3D%20pd.read_parquet(cached_annot_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_annot)%7D%20cached%20annotated%20variants%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22cache%22%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Run%20the%20authoritative%20annotation%20pipeline%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(%22Running%20authoritative%20variant%20annotation%20pipeline...%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20First%2C%20save%20filtered%20variants%20to%20the%20expected%20location%0A%20%20%20%20%20%20%20%20%20%20%20%20temp_path%20%3D%20VARIANTS_DIR%20%2F%20%22abca4_clinvar_vus.parquet%22%0A%20%20%20%20%20%20%20%20%20%20%20%20df_variants_filtered.to_parquet(temp_path)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20annotator%20%3D%20VariantAnnotator(input_dir%3DVARIANTS_DIR%2C%20output_dir%3DANNOTATIONS_DIR)%0A%20%20%20%20%20%20%20%20%20%20%20%20annotation_success%20%3D%20annotator.run()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20annotation_success%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annot%20%3D%20pd.read_parquet(cached_annot_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_annot)%7D%20annotated%20variants%20from%20pipeline%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22pipeline%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20DEMO_MODE_ENABLED%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.warning(%22Annotation%20pipeline%20failed%3B%20using%20minimal%20demo%20annotations%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annot%20%3D%20df_variants_filtered.copy()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20minimal%20demo%20columns%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20col%20in%20%5B%22transcript_id%22%2C%20%22vep_consequence%22%2C%20%22vep_impact%22%2C%20%22genomic_region%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20col%20not%20in%20df_annot.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annot%5Bcol%5D%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22demo%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.error(%22Annotation%20pipeline%20failed.%20Enable%20DEMO_MODE_ENABLED%20in%20src%2Fconfig.py%20for%20demo%20data.%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annot%20%3D%20pd.DataFrame()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22error%22%0A%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20logger.error(f%22Failed%20to%20run%20annotation%20pipeline%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20if%20DEMO_MODE_ENABLED%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(%22Demo%20mode%3A%20Using%20minimal%20fallback%20annotations%22)%0A%20%20%20%20%20%20%20%20df_annot%20%3D%20df_variants_filtered.copy()%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20minimal%20demo%20columns%0A%20%20%20%20%20%20%20%20for%20col%20in%20%5B%22transcript_id%22%2C%20%22vep_consequence%22%2C%20%22vep_impact%22%2C%20%22genomic_region%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20col%20not%20in%20df_annot.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annot%5Bcol%5D%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22demo%22%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(%22Annotation%20failed.%20Enable%20DEMO_MODE_ENABLED%20in%20src%2Fconfig.py%20for%20demo%20data.%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_annot%20%3D%20pd.DataFrame()%0A%20%20%20%20%20%20%20%20%20%20%20%20annotation_source%20%3D%20%22error%22%0A%0A%20%20%20%20logger.info(f%22Annotation%20complete.%20Ready%20for%20feature%20engineering.%22)%0A%20%20%20%20df_annot.attrs%5B'source'%5D%20%3D%20annotation_source%0A%20%20%20%20return%20(df_annot%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_annot%2C%20mo)%3A%0A%20%20%20%20%22%22%22Show%20annotation%20data%20provenance.%22%22%22%0A%20%20%20%20annot_source%20%3D%20df_annot.attrs.get('source'%2C%20'unknown')%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Annotation%20source%3A**%20%60%7Bannot_source%7D%60%0A%0A%20%20%20%20Cached%20annotations%20skip%20pyensembl%2FVEPlac%20calls%3B%20%60pipeline%60%20indicates%20this%20run%20hit%20the%20Ensembl%20APIs.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_annot%2C%20mo)%3A%0A%20%20%20%20%22%22%22Display%20consequence%20distribution.%22%22%22%0A%20%20%20%20if%20%22consequence%22%20in%20df_annot.columns%20and%20not%20df_annot.empty%3A%0A%20%20%20%20%20%20%20%20_consequence_counts%20%3D%20df_annot%5B%22consequence%22%5D.value_counts().to_frame(%22count%22)%0A%20%20%20%20%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%23%20Consequence%20Distribution%0A%20%20%20%20%22%22%22)%0A%20%20%20%20%20%20%20%20mo.ui.table(_consequence_counts.head(10).reset_index())%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20consequence%20data%20available.%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_annot)%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20Pass%20annotated%20variants%20forward.%0A%0A%20%20%20%20Detailed%20feature%20engineering%20(gnomAD%2C%20conservation%2C%20regulatory%2C%20domains)%0A%20%20%20%20happens%20in%20the%20next%20notebook%20(02_feature_engineering.py)%20which%20calls%3A%0A%20%20%20%20-%20campaigns%2Fabca4%2Fsrc%2Ffeatures%2Fregulatory.py%20(gnomAD%20%2B%20domain%20mapping)%0A%20%20%20%20-%20campaigns%2Fabca4%2Fsrc%2Ffeatures%2Fconservation.py%20(phyloP%2FphastCons)%0A%20%20%20%20-%20campaigns%2Fabca4%2Fsrc%2Ffeatures%2Fmissense.py%20(AlphaMissense%20scores)%0A%20%20%20%20-%20campaigns%2Fabca4%2Fsrc%2Ffeatures%2Fsplice.py%20(SpliceAI%20scores)%0A%20%20%20%20%22%22%22%0A%20%20%20%20df_domains%20%3D%20df_annot.copy()%0A%20%20%20%20return%20(df_domains%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22Note%20about%20domain%20distribution.%22%22%22%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%23%20Domain%20Annotation%0A%0A%20%20%20%20Domain%20mapping%20and%20regulatory%20features%20will%20be%20added%20in%20the%20next%20notebook%0A%20%20%20%20(02_feature_engineering.py)%20using%20the%20authoritative%20domain%20configuration%0A%20%20%20%20and%20gnomAD%20data.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_domains%2C%20mo%2C%20pd)%3A%0A%20%20%20%20%22%22%22Display%20completeness%20metrics.%22%22%22%0A%20%20%20%20_key_cols%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22chrom%22%2C%20%22pos%22%2C%20%22ref%22%2C%20%22alt%22%2C%20%22clinical_significance%22%2C%0A%20%20%20%20%20%20%20%20%22consequence%22%2C%20%22gnomad_af%22%2C%20%22phylop_score%22%2C%20%22domain%22%0A%20%20%20%20%5D%0A%20%20%20%20_completeness%20%3D%20%7B%7D%0A%20%20%20%20for%20_col%20in%20_key_cols%3A%0A%20%20%20%20%20%20%20%20if%20_col%20in%20df_domains.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_completeness%5B_col%5D%20%3D%20df_domains%5B_col%5D.notna().sum()%20%2F%20len(df_domains)%20if%20len(df_domains)%20%3E%200%20else%200.0%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_completeness%5B_col%5D%20%3D%200.0%0A%0A%20%20%20%20_comp_df%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%5B(k%2C%20f%22%7Bv%3A.1%25%7D%22)%20for%20k%2C%20v%20in%20_completeness.items()%5D%2C%0A%20%20%20%20%20%20%20%20columns%3D%5B%22Field%22%2C%20%22Completeness%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%23%20Annotation%20Completeness%0A%0A%20%20%20%20Key%20fields%20completeness%20check%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20mo.ui.table(_comp_df)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_domains%2C%20logger)%3A%0A%20%20%20%20%22%22%22Export%20annotated%20variants%20to%20disk.%22%22%22%0A%20%20%20%20from%20src.config%20import%20get_annotated_variants_path%0A%20%20%20%20output_path_annot%20%3D%20get_annotated_variants_path()%0A%20%20%20%20df_domains.to_parquet(output_path_annot)%0A%20%20%20%20logger.info(f%22Wrote%20annotated%20variants%20to%20%7Boutput_path_annot%7D%22)%0A%20%20%20%20return%20(output_path_annot%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20output_path_annot)%3A%0A%20%20%20%20%22%22%22Confirm%20export.%22%22%22%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Annotation%20Complete**%0A%0A%20%20%20%20Saved%20to%3A%20%60%7Boutput_path_annot%7D%60%0A%0A%20%20%20%20**Next%20Step%3A**%20Open%20%6002_feature_engineering.py%60%20to%20add%20model%20scores%20and%20construct%20impact%20metrics.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22Tie%20this%20notebook%20back%20to%20the%20v1%20plan.%22%22%22%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%23%20Plan%20Alignment%0A%0A%20%20%20%20-%20**Step%E2%80%AF1%20%E2%80%93%20Data%20ingest%20(ClinVar%20%2B%20partner%20variants)%3A**%20Completed%20above%20via%20%60filter_abca4_variants.py%60%2C%20outputs%20now%20cached%20under%20%60data_processed%2Fvariants%2F%60.%0A%20%20%20%20-%20**Step%E2%80%AF2%20%E2%80%93%20Annotation%20%26%20deterministic%20features%3A**%20Completed%20via%20%60annotate_transcripts.py%60%20(VEP%2Fpyensembl).%20The%20resulting%20%60variants_annotated.parquet%60%20is%20the%20hand-off%20into%20feature%20engineering.%0A%0A%20%20%20%20This%20notebook%20is%20now%20the%20authoritative%20entry%20point%20for%20Steps%E2%80%AF0%E2%80%912%20of%20the%20ABCA4%20v1%20pipeline.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">f5d6a22fb2b3e02595a12e495b842dc4</marimo-code-hash>
</body>
</html>
