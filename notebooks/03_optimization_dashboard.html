<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>03_optimization_dashboard.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>03 optimization dashboard</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-DUlb-6KU.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Combination-CJczP3q7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/menu-items-CKlDAcIy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Cn3C5h2V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/select-E33nSIDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/multi-map-CMSc8wqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dropdown-menu-k3cvSs56.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-QlUG_0sW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utils-BPcfRUDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ai-model-dropdown-BuNmF2aO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/badge-DrRlgkPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/config-DOzlN8_n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNonce-CElEIK4R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-CAMtfgeb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/kbd-BEZA_QXE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/renderShortcut-Cp1zXREV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEvent-mw3fc-le.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeleteCell-yV4YK-xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lazy-NLnLn6Pi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-D-ie3mwB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/precisionRound-JPbfj2M2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-DzEPn_Ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vega-loader.browser-BJKnSXO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-CyyA9NKX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-dialog-DkIHCxse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dialog-DZWinI5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDebounce-Dc646H0x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/numbers-BrVMv_xq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/SSRProvider-3gFeNiun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/context-By5V2JVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNumberFormatter-BFHkt56k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/usePress-CqxmpITG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/input-lkQFhlrZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ImperativeModal-kroC_7ut.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cell-link-CGc-QK-U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-DZiaW65G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/links-Cd3tV5IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/state-dWjslxDZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/MarimoErrorOutput-CkZl2oHu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spinner-CM1AwwT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/strings-jhyl_xMu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/command-CgWi9W7A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/popover-ieUH9gue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useRunCells-DSf9mKXo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-zuiMeyCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-icon-DFLZbTfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mode-BAOMKXFj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/purify.es-BNe8OHFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/RenderHTML-DII6L-pL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-Ny605LgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tabs-DvBunSCS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAsyncData-BIQYiPhO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useIframeCapabilities-CRfeZulz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/error-banner-B98iBZZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/formats-Dmio8FVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useTheme-Dsb69ewj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/en-US-Cok_jNd9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isValid-BhOWABEg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/maps-B9m998ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shim-DuR5ZJNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-C81Fxkfa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/extends-BADOB1Xm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/emotion-is-prop-valid.esm-DY_d0mBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDateFormatter-DHQNk42q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-bwodJiCi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/name-cell-input-kfZkR5qv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useHotkey-VwOksnmL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-B1wJF59y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4dFcbt8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CzaCAuEN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CrvuMM2L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DZAt7AHl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Bu5OuYeo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist--8e9VGsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-SXxUBTmG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D84pVwY7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CXTAKsYC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BUfDRi87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CJIkd1DM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D5QNAo1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/apl-CAJ5Afpm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asciiarmor-B3glo3Hy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asn1-iaUkdUJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/brainfuck-C1Bv_mwK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clike-BEDWkorR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clojure-g07QXTjj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cmake-DnTqIimN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cobol-BKtG7u9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/coffeescript-D5EX_wGl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/commonlisp-QBdsjaTi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/crystal-B0kV858U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/css-lnqtDlV_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cypher-B_ciRc6O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/d-sGSUUdz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/diff-okFUO1eS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dtd-Covqp7FW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dylan-Bf_wFnkY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ecl-BON4bJzJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eiffel-CWbinnR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/elm-DKVclpIr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/erlang-D7Lapqoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/simple-mode-NsCUKpko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/factor-B2ESt4eh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/forth-CCfEYbe1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/fortran-ph1UcBiZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gas-BwHh1zIK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gherkin-a-S-92sq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/groovy-W6xB3OYy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haskell-DCE9UteQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haxe-CLcQehNU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/idl-VKcM9gU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/javascript-3wn7R2v8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mllike-BBifUJsv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/nsis-z1VCt9tx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pug-CaaLw7eE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/python-Dt99D71K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-BJLcBgU0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/objectWithoutPropertiesLoose-BhduYW5j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-DXZXojh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-C8_hvhi2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BwPQWTZk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/icons-DVWpV4I_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-missing-import-CgnlhMvv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/blob-BgGJeXvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-cell-with-ai-B5g8vtHB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-function-C7Ij9TAd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spec-D64rpvwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/focus-Bg0Cm8D6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useInstallPackage-CX-LUKF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/column-preview-CEDUFvMb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAddCell-C5hu4Wun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toggle-6a-IWcUo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/api-B8WZp3pa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globals-DlvGFwxH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/share-Cyx6Ke3B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4J1GeSh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utilities.esm-BUZA9ZNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/floating-outline-DJ1FXuVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eye-off-DNEZNQI7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/plus-VNKMcdhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/readonly-python-code-B1LohqR_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-video-camera-Bt4f7oOT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-text-KeEJTZsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-DU2hKpP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-CKcqkReK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/label-BnC8-64i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-x7Qa7Rrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textarea-faXBMy_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-ccw-Dmg0YI4-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-2-BsccpX3E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-CAATHPdC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/field-D6TVJZGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/switch-DBfU9QHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useBoolean-Do2iSPXV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeepCompareMemoize-DVzR9zu0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/LazyAnyLanguageCodeMirror-C5EeHVjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-BfF9hgo8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/prop-types-DVt2dPhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/es-Bve1w9dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/VisuallyHidden-BhVlvbgE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globe-DW6c4--m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/send-DjnZs47z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-cw-z53rVhjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/settings-Dt7V2Blo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/triangle-alert-DoSv9yQr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/bundle.esm-CC-LjhS-.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-CYOH-TAt.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "03_optimization_dashboard.py",
            "mode": "read",
            "version": "0.17.8",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": false, "show_output": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "\"\"\"Setup path and import core libraries.\"\"\"\nimport sys\nfrom pathlib import Path\n# Add project root to path (works for both notebook and exported script)\ntry:\n    _file_path = Path(__file__).resolve()\nexcept NameError:\n    _file_path = Path.cwd() / \"notebooks\" / \"03_optimization_dashboard.py\"\n_project_root = _file_path.parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\nimport marimo as mo\nimport pandas as pd\nfrom src.config import logger\nfrom src.reward.optimization import VariantOptimizer\nfrom src.features.docs import PipelineDocs", "code_hash": "3a59d142b47ec1af768d448e2b931d05", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "__"}, {"code": "\"\"\"Notebook title and introduction.\"\"\"\nmo.md(PipelineDocs.get_optimization_intro())", "code_hash": "d4ef74142331d8dc49b231cddf4c7a2c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "__"}, {"code": "\"\"\"Load scored variants for optimization.\"\"\"\nfrom src.config import FEATURES_DIR\n\nscored_path = FEATURES_DIR / \"variants_scored.parquet\"\nif not scored_path.exists():\n    mo.md(f\"\u274c Missing variants_scored.parquet at {scored_path}\")\n    df_scored_optim = None\nelse:\n    df_scored_optim = pd.read_parquet(scored_path)\n    logger.info(f\"Loaded {len(df_scored_optim)} scored variants for optimization\")\n\n    # Validate required columns\n    required_cols = ['model_score', 'cluster_id', 'cluster_target']\n    missing_cols = [col for col in required_cols if col not in df_scored_optim.columns]\n\n    if missing_cols:\n        mo.md(f\"\u274c Missing required columns: {missing_cols}\")\n        df_scored_optim = None\n    else:\n        mo.md(f\"\u2705 Loaded {len(df_scored_optim)} variants with {df_scored_optim['cluster_id'].nunique()} clusters\")", "code_hash": "5b26760252b756d9dfd39790e6a8f55a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "__"}, {"code": "\"\"\"Optimization parameter controls.\"\"\"\nif df_scored_optim is None or df_scored_optim.empty:\n    mo.md(\"No scored variants available for optimization.\")\n    k_optim = strat_optim = lambda_cov = None\nelse:\n    mo.md(\"### Optimization Parameters\")\n\n    k_optim = mo.ui.slider(\n        10, min(200, len(df_scored_optim)),\n        value=min(30, len(df_scored_optim)),\n        label=\"Panel Size (K)\"\n    )\n\n    strat_optim = mo.ui.radio(\n        options=[\"Greedy coverage\", \"Top score\", \"Random\"],\n        value=\"Greedy coverage\",\n        label=\"Strategy\"\n    )\n\n    lambda_cov = mo.ui.slider(\n        0.0, 2.0, value=0.6, step=0.05, label=\"Coverage penalty \u03bb\"\n    )", "code_hash": "98e21de546b6f2d5418d36373b21fa52", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "__"}, {"code": "\"\"\"Display chosen strategy.\"\"\"\nif strat_optim is None:\n    mo.md(\"Select a strategy to proceed.\")\nelse:\n    mo.md(f\"**Strategy:** {strat_optim.value}\\n\\n**Coverage \u03bb:** {lambda_cov.value if lambda_cov else 0}\")", "code_hash": "7b2d506db5b586bc5f31c6604731b430", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "__"}, {"code": "\"\"\"Run optimization using modular utilities.\"\"\"\nif df_scored_optim is None or k_optim is None or strat_optim is None:\n    mo.md(\"Cannot run optimization - missing data or parameters.\")\n    optim_results = None\nelse:\n    try:\n        # Prepare data for optimization\n        df_opt = VariantOptimizer.prepare_optimization_data(df_scored_optim)\n        cluster_targets = df_opt[['cluster_id', 'cluster_target']].drop_duplicates().set_index('cluster_id')['cluster_target'].to_dict()\n\n        # Run optimization based on strategy\n        if strat_optim.value == \"Greedy coverage\":\n            selected = VariantOptimizer.select_greedy(\n                df_opt, k_optim.value, lambda_cov.value, cluster_targets\n            )\n            optim_mode = \"greedy_coverage\"\n        elif strat_optim.value == \"Top score\":\n            # For comparison, always compute top-K\n            selected = VariantOptimizer.select_greedy(df_opt, k_optim.value, 0.0, {})  # No coverage penalty\n            optim_mode = \"top_score\"\n        elif strat_optim.value == \"Random\":\n            _selected = df_opt.sample(n=k_optim.value, random_state=42).copy()\n            _selected['optimization_score'] = _selected['impact_score'] if 'impact_score' in _selected.columns else _selected['model_score']\n            _selected['selected'] = True\n            _selected['rank'] = range(1, len(_selected) + 1)\n            optim_mode = \"random\"\n        else:\n            mo.md(f\"\u274c Unsupported strategy: {strat_optim.value}\")\n            optim_results = None\n\n        # Always compute top-K for comparison\n        top_k_by_score = VariantOptimizer.select_greedy(df_opt, k_optim.value, 0.0, {})  # No coverage penalty\n\n        # Handle different selection strategies\n        if strat_optim.value == \"Random\":\n            final_selected = _selected\n        else:\n            final_selected = selected\n\n        # Compute comparison metrics\n        _comparison = VariantOptimizer.compute_comparison_metrics(final_selected, top_k_by_score)\n\n        optim_results = {\n            \"strategy\": strat_optim.value,\n            \"k\": k_optim.value,\n            \"coverage_lambda\": lambda_cov.value if lambda_cov else 0.0,\n            \"selected_variants\": final_selected,\n            \"top_k_by_score\": top_k_by_score,\n            \"comparison\": _comparison,\n            \"mode\": optim_mode\n        }\n\n        logger.info(f\"Optimization complete: {optim_mode}, selected {len(final_selected)} variants\")\n\n    except Exception as e:\n        logger.error(f\"Optimization failed: {e}\")\n        mo.md(f\"\u274c Optimization failed: {e}\")\n        optim_results = None", "code_hash": "d16e1c9da6cdac6f1c70fff87e5b9968", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "__"}, {"code": "\"\"\"Display optimization results and comparison.\"\"\"\nif optim_results is None:\n    mo.md(\"No optimization results to display.\")\nelse:\n    # Use modular template for results display\n    mo.md(PipelineDocs.get_optimization_results_template(optim_results))", "code_hash": "3b6769baf7aa0d4b66f8ac7010e92e35", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "__"}, {"code": "\"\"\"Display optimization score distribution.\"\"\"\nif optim_results is None or 'selected_variants' not in optim_results:\n    mo.md(\"No results to plot.\")\nelse:\n    try:\n        import plotly.graph_objects as go\n\n        _selected = optim_results['selected_variants']\n        fig = go.Figure()\n\n        fig.add_trace(go.Bar(\n            x=_selected[\"rank\"],\n            y=_selected[\"optimization_score\"],\n            name=\"Selected Variants\",\n            marker_color=\"lightseagreen\"\n        ))\n\n        fig.update_layout(\n            title=\"Selected Variants by Optimization Score\",\n            xaxis_title=\"Rank\",\n            yaxis_title=\"Score\",\n            showlegend=False,\n            template=\"plotly_white\"\n        )\n\n        mo.ui.plotly(fig)\n\n    except Exception as e:\n        mo.md(f\"\u274c Plot error: {e}\")", "code_hash": "562f2f0a75cc0f289092b37732a9ca4e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "__"}, {"code": "\"\"\"Export selected variants.\"\"\"\nif optim_results is None or 'selected_variants' not in optim_results:\n    mo.md(\"No results to export.\")\nelse:\n    try:\n        from src.config import REPORTS_DIR\n\n        _selected = optim_results['selected_variants']\n\n        # Export CSV\n        csv_path = REPORTS_DIR / \"variants_selected.csv\"\n        _selected.to_csv(csv_path, index=False)\n\n        # Export JSON\n        json_path = REPORTS_DIR / \"variants_selected.json\"\n        _selected.to_json(json_path, orient='records', indent=2)\n\n        mo.md(f\"\u2705 **Exported {len(_selected)} variants to:**\\n- {csv_path}\\n- {json_path}\")\n\n    except Exception as e:\n        mo.md(f\"\u274c Export failed: {e}\")", "code_hash": "47c350aa704af04903412b755c2f44de", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "__"}, {"code": "\"\"\"Summary and next steps.\"\"\"\nif optim_results is None:\n    mo.md(\"Optimization incomplete.\")\nelse:\n    _comparison = optim_results.get('comparison', {})\n    impact_diff = _comparison.get('impact_diff_pct', 0)\n\n    status = \"\u2705 **SUCCESS**\" if abs(impact_diff) \u003C= 5 else \"\u26a0\ufe0f **REVIEW NEEDED**\"\n\n    mo.md(f\"\"\"\n## Optimization Summary\n\n{status}\n\n**Panel Size:** {optim_results['k']} variants\n**Strategy:** {optim_results['strategy']}\n**Coverage \u03bb:** {optim_results['coverage_lambda']}\n\n**Impact vs Baseline:** {impact_diff:+.1f}%\n\n### Next Steps\n\n1. **Review selected variants** in exported CSV/JSON files\n2. **Generate assay drafts** using `invoke reporting.drafts` or `invoke run-pipeline`\n3. **Proceed to CRO planning** for experimental design (includes LLM-generated assay drafts)\n4. **Adjust parameters** if optimization results need improvement\n\n**Assay Drafts Output:** `data_processed/reports/assay_drafts/`\n\"\"\")", "code_hash": "951dc2c854f0a5fd7d1a933970a4aa31", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "__"}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "3a59d142b47ec1af768d448e2b931d05", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d4ef74142331d8dc49b231cddf4c7a2c", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"abca4-variant-selection-optimization-dashboard\"\u003EABCA4 Variant Selection: Optimization Dashboard\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EInteractive optimization of variant panels with coverage constraints.\u003C/span\u003E\n\u003Ch2 id=\"selection-strategies\"\u003ESelection Strategies\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EGreedy Coverage\u003C/strong\u003E: Maximizes total impact while meeting cluster thresholds\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ETop-K by Score\u003C/strong\u003E: Simple ranking by impact score (baseline)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ECEM\u003C/strong\u003E: Cross-Entropy Method for complex optimization\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ERandom\u003C/strong\u003E: Random sampling (control)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"coverage-constraints\"\u003ECoverage Constraints\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EEach cluster j has target threshold \u03c4\u2c7c. Selection optimizes:\u003C/span\u003E\n\u003Cdiv class=\"language-text codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003Emax \u03a3\u1d62 score\u1d62 - \u03bb \u00d7 \u03a3\u2c7c max(0, \u03c4\u2c7c - cov\u2c7c(S))\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003EWhere cov\u2c7c(S) = max score of selected variants in cluster j.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5b26760252b756d9dfd39790e6a8f55a", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "2025-11-17 20:09:39,803 - INFO - Loaded 2118 scored variants for optimization\n", "type": "stream"}], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "98e21de546b6f2d5418d36373b21fa52", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7b2d506db5b586bc5f31c6604731b430", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "The truth value of a UIElement is always True. You probably want to call `.value` instead.", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d16e1c9da6cdac6f1c70fff87e5b9968", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "2025-11-17 20:09:44,074 - INFO - Optimization complete: \u03bb=0.6, K=30\n2025-11-17 20:09:44,074 - INFO -   Cluster unknown_other: \u03c4\u2c7c=0.074, cov=0.000, \u274c shortfall 0.074\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD2_missense_variant: \u03c4\u2c7c=0.254, cov=0.359, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD1_missense_variant: \u03c4\u2c7c=0.267, cov=0.338, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD1_missense_variant: \u03c4\u2c7c=0.263, cov=0.318, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster other_missense_variant: \u03c4\u2c7c=0.384, cov=0.302, \u274c shortfall 0.082\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD1_missense_variant,splice_region_variant: \u03c4\u2c7c=0.409, cov=0.381, \u274c shortfall 0.028\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD2_missense_variant,splice_region_variant: \u03c4\u2c7c=0.231, cov=0.368, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD2_missense_variant: \u03c4\u2c7c=0.325, cov=0.504, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD2_missense_variant,splice_region_variant: \u03c4\u2c7c=0.244, cov=0.311, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_intron_variant: \u03c4\u2c7c=0.081, cov=0.000, \u274c shortfall 0.081\n2025-11-17 20:09:44,074 - INFO -   Cluster utr: \u03c4\u2c7c=0.066, cov=0.000, \u274c shortfall 0.066\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD2_synonymous_variant: \u03c4\u2c7c=0.150, cov=0.307, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_splice_donor_region_variant,intron_variant: \u03c4\u2c7c=0.137, cov=0.250, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD2_splice_region_variant,synonymous_variant: \u03c4\u2c7c=0.161, cov=0.000, \u274c shortfall 0.161\n2025-11-17 20:09:44,074 - INFO -   Cluster other_synonymous_variant: \u03c4\u2c7c=0.138, cov=0.000, \u274c shortfall 0.138\n2025-11-17 20:09:44,074 - INFO -   Cluster CTD_missense_variant: \u03c4\u2c7c=0.353, cov=0.397, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_splice_region_variant,splice_polypyrimidine_tract_variant,intron_variant: \u03c4\u2c7c=0.156, cov=0.000, \u274c shortfall 0.156\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD1_synonymous_variant: \u03c4\u2c7c=0.162, cov=0.000, \u274c shortfall 0.162\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD1_missense_variant,splice_region_variant: \u03c4\u2c7c=0.375, cov=0.388, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_splice_donor_5th_base_variant,intron_variant: \u03c4\u2c7c=0.113, cov=0.000, \u274c shortfall 0.113\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_splice_region_variant,intron_variant: \u03c4\u2c7c=0.174, cov=0.282, \u2705 MET\n2025-11-17 20:09:44,074 - INFO -   Cluster CTD_stop_gained: \u03c4\u2c7c=0.180, cov=0.000, \u274c shortfall 0.180\n2025-11-17 20:09:44,074 - INFO -   Cluster other_stop_lost: \u03c4\u2c7c=0.240, cov=0.000, \u274c shortfall 0.240\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD2_inframe_insertion: \u03c4\u2c7c=0.115, cov=0.000, \u274c shortfall 0.115\n2025-11-17 20:09:44,074 - INFO -   Cluster other_missense_variant,splice_region_variant: \u03c4\u2c7c=0.668, cov=0.421, \u274c shortfall 0.247\n2025-11-17 20:09:44,074 - INFO -   Cluster CTD_missense_variant,splice_region_variant: \u03c4\u2c7c=0.302, cov=0.239, \u274c shortfall 0.063\n2025-11-17 20:09:44,074 - INFO -   Cluster intronic_splice_polypyrimidine_tract_variant,intron_variant: \u03c4\u2c7c=0.352, cov=0.000, \u274c shortfall 0.352\n2025-11-17 20:09:44,074 - INFO -   Cluster TMD1_splice_region_variant,synonymous_variant: \u03c4\u2c7c=0.125, cov=0.000, \u274c shortfall 0.125\n2025-11-17 20:09:44,074 - INFO -   Cluster NBD2_inframe_insertion: \u03c4\u2c7c=0.166, cov=0.000, \u274c shortfall 0.166\n2025-11-17 20:09:44,074 - INFO -   Cluster CTD_synonymous_variant: \u03c4\u2c7c=0.142, cov=0.000, \u274c shortfall 0.142\n2025-11-17 20:09:44,075 - INFO -   Cluster TMD2_synonymous_variant: \u03c4\u2c7c=0.152, cov=0.000, \u274c shortfall 0.152\n2025-11-17 20:09:44,075 - INFO -   Cluster CTD_splice_region_variant,synonymous_variant: \u03c4\u2c7c=0.088, cov=0.000, \u274c shortfall 0.088\n2025-11-17 20:09:44,075 - INFO -   Cluster CTD_inframe_insertion: \u03c4\u2c7c=0.164, cov=0.000, \u274c shortfall 0.164\n2025-11-17 20:09:44,075 - INFO -   Cluster NBD1_synonymous_variant: \u03c4\u2c7c=0.361, cov=0.000, \u274c shortfall 0.361\n2025-11-17 20:09:44,075 - INFO -   Cluster NBD1_splice_region_variant,synonymous_variant: \u03c4\u2c7c=0.153, cov=0.000, \u274c shortfall 0.153\n2025-11-17 20:09:47,705 - INFO - Optimization complete: \u03bb=0.0, K=30\nThe truth value of a UIElement is always True. You probably want to call `.value` instead.2025-11-17 20:09:47,706 - INFO - Optimization complete: greedy_coverage, selected 30 variants\n", "type": "stream"}], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "3b6769baf7aa0d4b66f8ac7010e92e35", "console": [], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "562f2f0a75cc0f289092b37732a9ca4e", "console": [], "id": "SFPL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "47c350aa704af04903412b755c2f44de", "console": [], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "951dc2c854f0a5fd7d1a933970a4aa31", "console": [], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.8%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%22%22%22Setup%20path%20and%20import%20core%20libraries.%22%22%22%0A%20%20%20%20import%20sys%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20%23%20Add%20project%20root%20to%20path%20(works%20for%20both%20notebook%20and%20exported%20script)%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path(__file__).resolve()%0A%20%20%20%20except%20NameError%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path.cwd()%20%2F%20%22notebooks%22%20%2F%20%2203_optimization_dashboard.py%22%0A%20%20%20%20_project_root%20%3D%20_file_path.parent.parent%0A%20%20%20%20if%20str(_project_root)%20not%20in%20sys.path%3A%0A%20%20%20%20%20%20%20%20sys.path.insert(0%2C%20str(_project_root))%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20from%20src.config%20import%20logger%0A%20%20%20%20from%20src.reward.optimization%20import%20VariantOptimizer%0A%20%20%20%20from%20src.features.docs%20import%20PipelineDocs%0A%20%20%20%20return%20PipelineDocs%2C%20VariantOptimizer%2C%20logger%2C%20mo%2C%20pd%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20mo)%3A%0A%20%20%20%20%22%22%22Notebook%20title%20and%20introduction.%22%22%22%0A%20%20%20%20mo.md(PipelineDocs.get_optimization_intro())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(logger%2C%20mo%2C%20pd)%3A%0A%20%20%20%20%22%22%22Load%20scored%20variants%20for%20optimization.%22%22%22%0A%20%20%20%20from%20src.config%20import%20FEATURES_DIR%0A%0A%20%20%20%20scored_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.parquet%22%0A%20%20%20%20if%20not%20scored_path.exists()%3A%0A%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Missing%20variants_scored.parquet%20at%20%7Bscored_path%7D%22)%0A%20%20%20%20%20%20%20%20df_scored_optim%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20df_scored_optim%20%3D%20pd.read_parquet(scored_path)%0A%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_scored_optim)%7D%20scored%20variants%20for%20optimization%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Validate%20required%20columns%0A%20%20%20%20%20%20%20%20required_cols%20%3D%20%5B'model_score'%2C%20'cluster_id'%2C%20'cluster_target'%5D%0A%20%20%20%20%20%20%20%20missing_cols%20%3D%20%5Bcol%20for%20col%20in%20required_cols%20if%20col%20not%20in%20df_scored_optim.columns%5D%0A%0A%20%20%20%20%20%20%20%20if%20missing_cols%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Missing%20required%20columns%3A%20%7Bmissing_cols%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_scored_optim%20%3D%20None%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20Loaded%20%7Blen(df_scored_optim)%7D%20variants%20with%20%7Bdf_scored_optim%5B'cluster_id'%5D.nunique()%7D%20clusters%22)%0A%20%20%20%20return%20(df_scored_optim%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_scored_optim%2C%20mo)%3A%0A%20%20%20%20%22%22%22Optimization%20parameter%20controls.%22%22%22%0A%20%20%20%20if%20df_scored_optim%20is%20None%20or%20df_scored_optim.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20scored%20variants%20available%20for%20optimization.%22)%0A%20%20%20%20%20%20%20%20k_optim%20%3D%20strat_optim%20%3D%20lambda_cov%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Optimization%20Parameters%22)%0A%0A%20%20%20%20%20%20%20%20k_optim%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20%20%20%20%2010%2C%20min(200%2C%20len(df_scored_optim))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Dmin(30%2C%20len(df_scored_optim))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Panel%20Size%20(K)%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20strat_optim%20%3D%20mo.ui.radio(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3D%5B%22Greedy%20coverage%22%2C%20%22Top%20score%22%2C%20%22Random%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22Greedy%20coverage%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Strategy%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20lambda_cov%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20%20%20%20%200.0%2C%202.0%2C%20value%3D0.6%2C%20step%3D0.05%2C%20label%3D%22Coverage%20penalty%20%CE%BB%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20k_optim%2C%20lambda_cov%2C%20strat_optim%0A%0A%0A%40app.cell%0Adef%20_(lambda_cov%2C%20mo%2C%20strat_optim)%3A%0A%20%20%20%20%22%22%22Display%20chosen%20strategy.%22%22%22%0A%20%20%20%20if%20strat_optim%20is%20None%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Select%20a%20strategy%20to%20proceed.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20mo.md(f%22**Strategy%3A**%20%7Bstrat_optim.value%7D%5Cn%5Cn**Coverage%20%CE%BB%3A**%20%7Blambda_cov.value%20if%20lambda_cov%20else%200%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20VariantOptimizer%2C%0A%20%20%20%20df_scored_optim%2C%0A%20%20%20%20k_optim%2C%0A%20%20%20%20lambda_cov%2C%0A%20%20%20%20logger%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20strat_optim%2C%0A)%3A%0A%20%20%20%20%22%22%22Run%20optimization%20using%20modular%20utilities.%22%22%22%0A%20%20%20%20if%20df_scored_optim%20is%20None%20or%20k_optim%20is%20None%20or%20strat_optim%20is%20None%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20run%20optimization%20-%20missing%20data%20or%20parameters.%22)%0A%20%20%20%20%20%20%20%20optim_results%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Prepare%20data%20for%20optimization%0A%20%20%20%20%20%20%20%20%20%20%20%20df_opt%20%3D%20VariantOptimizer.prepare_optimization_data(df_scored_optim)%0A%20%20%20%20%20%20%20%20%20%20%20%20cluster_targets%20%3D%20df_opt%5B%5B'cluster_id'%2C%20'cluster_target'%5D%5D.drop_duplicates().set_index('cluster_id')%5B'cluster_target'%5D.to_dict()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Run%20optimization%20based%20on%20strategy%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20strat_optim.value%20%3D%3D%20%22Greedy%20coverage%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selected%20%3D%20VariantOptimizer.select_greedy(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_opt%2C%20k_optim.value%2C%20lambda_cov.value%2C%20cluster_targets%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optim_mode%20%3D%20%22greedy_coverage%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20strat_optim.value%20%3D%3D%20%22Top%20score%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20For%20comparison%2C%20always%20compute%20top-K%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selected%20%3D%20VariantOptimizer.select_greedy(df_opt%2C%20k_optim.value%2C%200.0%2C%20%7B%7D)%20%20%23%20No%20coverage%20penalty%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optim_mode%20%3D%20%22top_score%22%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20strat_optim.value%20%3D%3D%20%22Random%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_selected%20%3D%20df_opt.sample(n%3Dk_optim.value%2C%20random_state%3D42).copy()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_selected%5B'optimization_score'%5D%20%3D%20_selected%5B'impact_score'%5D%20if%20'impact_score'%20in%20_selected.columns%20else%20_selected%5B'model_score'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_selected%5B'selected'%5D%20%3D%20True%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_selected%5B'rank'%5D%20%3D%20range(1%2C%20len(_selected)%20%2B%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optim_mode%20%3D%20%22random%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Unsupported%20strategy%3A%20%7Bstrat_optim.value%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optim_results%20%3D%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Always%20compute%20top-K%20for%20comparison%0A%20%20%20%20%20%20%20%20%20%20%20%20top_k_by_score%20%3D%20VariantOptimizer.select_greedy(df_opt%2C%20k_optim.value%2C%200.0%2C%20%7B%7D)%20%20%23%20No%20coverage%20penalty%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Handle%20different%20selection%20strategies%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20strat_optim.value%20%3D%3D%20%22Random%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20final_selected%20%3D%20_selected%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20final_selected%20%3D%20selected%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Compute%20comparison%20metrics%0A%20%20%20%20%20%20%20%20%20%20%20%20_comparison%20%3D%20VariantOptimizer.compute_comparison_metrics(final_selected%2C%20top_k_by_score)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20optim_results%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22strategy%22%3A%20strat_optim.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22k%22%3A%20k_optim.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22coverage_lambda%22%3A%20lambda_cov.value%20if%20lambda_cov%20else%200.0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22selected_variants%22%3A%20final_selected%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22top_k_by_score%22%3A%20top_k_by_score%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22comparison%22%3A%20_comparison%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22mode%22%3A%20optim_mode%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Optimization%20complete%3A%20%7Boptim_mode%7D%2C%20selected%20%7Blen(final_selected)%7D%20variants%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Optimization%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Optimization%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20optim_results%20%3D%20None%0A%20%20%20%20return%20(optim_results%2C)%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20mo%2C%20optim_results)%3A%0A%20%20%20%20%22%22%22Display%20optimization%20results%20and%20comparison.%22%22%22%0A%20%20%20%20if%20optim_results%20is%20None%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20optimization%20results%20to%20display.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Use%20modular%20template%20for%20results%20display%0A%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_optimization_results_template(optim_results))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20optim_results)%3A%0A%20%20%20%20%22%22%22Display%20optimization%20score%20distribution.%22%22%22%0A%20%20%20%20if%20optim_results%20is%20None%20or%20'selected_variants'%20not%20in%20optim_results%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20results%20to%20plot.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_selected%20%3D%20optim_results%5B'selected_variants'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(go.Bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D_selected%5B%22rank%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D_selected%5B%22optimization_score%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22Selected%20Variants%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3D%22lightseagreen%22%0A%20%20%20%20%20%20%20%20%20%20%20%20))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Selected%20Variants%20by%20Optimization%20Score%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Rank%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Score%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20template%3D%22plotly_white%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.plotly(fig)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Plot%20error%3A%20%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20optim_results)%3A%0A%20%20%20%20%22%22%22Export%20selected%20variants.%22%22%22%0A%20%20%20%20if%20optim_results%20is%20None%20or%20'selected_variants'%20not%20in%20optim_results%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20results%20to%20export.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20src.config%20import%20REPORTS_DIR%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20_selected%20%3D%20optim_results%5B'selected_variants'%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Export%20CSV%0A%20%20%20%20%20%20%20%20%20%20%20%20csv_path%20%3D%20REPORTS_DIR%20%2F%20%22variants_selected.csv%22%0A%20%20%20%20%20%20%20%20%20%20%20%20_selected.to_csv(csv_path%2C%20index%3DFalse)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Export%20JSON%0A%20%20%20%20%20%20%20%20%20%20%20%20json_path%20%3D%20REPORTS_DIR%20%2F%20%22variants_selected.json%22%0A%20%20%20%20%20%20%20%20%20%20%20%20_selected.to_json(json_path%2C%20orient%3D'records'%2C%20indent%3D2)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20**Exported%20%7Blen(_selected)%7D%20variants%20to%3A**%5Cn-%20%7Bcsv_path%7D%5Cn-%20%7Bjson_path%7D%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Export%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20optim_results)%3A%0A%20%20%20%20%22%22%22Summary%20and%20next%20steps.%22%22%22%0A%20%20%20%20if%20optim_results%20is%20None%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Optimization%20incomplete.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20_comparison%20%3D%20optim_results.get('comparison'%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20impact_diff%20%3D%20_comparison.get('impact_diff_pct'%2C%200)%0A%0A%20%20%20%20%20%20%20%20status%20%3D%20%22%E2%9C%85%20**SUCCESS**%22%20if%20abs(impact_diff)%20%3C%3D%205%20else%20%22%E2%9A%A0%EF%B8%8F%20**REVIEW%20NEEDED**%22%0A%0A%20%20%20%20%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%20Optimization%20Summary%0A%0A%20%20%20%20%7Bstatus%7D%0A%0A%20%20%20%20**Panel%20Size%3A**%20%7Boptim_results%5B'k'%5D%7D%20variants%0A%20%20%20%20**Strategy%3A**%20%7Boptim_results%5B'strategy'%5D%7D%0A%20%20%20%20**Coverage%20%CE%BB%3A**%20%7Boptim_results%5B'coverage_lambda'%5D%7D%0A%0A%20%20%20%20**Impact%20vs%20Baseline%3A**%20%7Bimpact_diff%3A%2B.1f%7D%25%0A%0A%20%20%20%20%23%23%23%20Next%20Steps%0A%0A%20%20%20%201.%20**Review%20selected%20variants**%20in%20exported%20CSV%2FJSON%20files%0A%20%20%20%202.%20**Generate%20assay%20drafts**%20using%20%60invoke%20reporting.drafts%60%20or%20%60invoke%20run-pipeline%60%0A%20%20%20%203.%20**Proceed%20to%20CRO%20planning**%20for%20experimental%20design%20(includes%20LLM-generated%20assay%20drafts)%0A%20%20%20%204.%20**Adjust%20parameters**%20if%20optimization%20results%20need%20improvement%0A%0A%20%20%20%20**Assay%20Drafts%20Output%3A**%20%60data_processed%2Freports%2Fassay_drafts%2F%60%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">898ea2b8da452af23cdb9db2aea3a2a0</marimo-code-hash>
</body>
</html>
