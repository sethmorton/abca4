<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>02_feature_engineering.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>02 feature engineering</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-DUlb-6KU.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Combination-CJczP3q7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/menu-items-CKlDAcIy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Cn3C5h2V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/select-E33nSIDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/multi-map-CMSc8wqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dropdown-menu-k3cvSs56.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-QlUG_0sW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utils-BPcfRUDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ai-model-dropdown-BuNmF2aO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/badge-DrRlgkPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/config-DOzlN8_n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNonce-CElEIK4R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-CAMtfgeb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/kbd-BEZA_QXE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/renderShortcut-Cp1zXREV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEvent-mw3fc-le.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeleteCell-yV4YK-xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lazy-NLnLn6Pi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-D-ie3mwB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/precisionRound-JPbfj2M2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-DzEPn_Ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vega-loader.browser-BJKnSXO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-CyyA9NKX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-dialog-DkIHCxse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dialog-DZWinI5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDebounce-Dc646H0x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/numbers-BrVMv_xq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/SSRProvider-3gFeNiun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/context-By5V2JVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNumberFormatter-BFHkt56k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/usePress-CqxmpITG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/input-lkQFhlrZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ImperativeModal-kroC_7ut.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cell-link-CGc-QK-U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-DZiaW65G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/links-Cd3tV5IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/state-dWjslxDZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/MarimoErrorOutput-CkZl2oHu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spinner-CM1AwwT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/strings-jhyl_xMu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/command-CgWi9W7A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/popover-ieUH9gue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useRunCells-DSf9mKXo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-zuiMeyCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-icon-DFLZbTfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mode-BAOMKXFj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/purify.es-BNe8OHFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/RenderHTML-DII6L-pL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-Ny605LgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tabs-DvBunSCS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAsyncData-BIQYiPhO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useIframeCapabilities-CRfeZulz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/error-banner-B98iBZZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/formats-Dmio8FVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useTheme-Dsb69ewj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/en-US-Cok_jNd9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isValid-BhOWABEg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/maps-B9m998ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shim-DuR5ZJNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-C81Fxkfa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/extends-BADOB1Xm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/emotion-is-prop-valid.esm-DY_d0mBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDateFormatter-DHQNk42q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-bwodJiCi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/name-cell-input-kfZkR5qv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useHotkey-VwOksnmL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-B1wJF59y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4dFcbt8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CzaCAuEN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CrvuMM2L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DZAt7AHl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Bu5OuYeo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist--8e9VGsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-SXxUBTmG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D84pVwY7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CXTAKsYC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BUfDRi87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CJIkd1DM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D5QNAo1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/apl-CAJ5Afpm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asciiarmor-B3glo3Hy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asn1-iaUkdUJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/brainfuck-C1Bv_mwK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clike-BEDWkorR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clojure-g07QXTjj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cmake-DnTqIimN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cobol-BKtG7u9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/coffeescript-D5EX_wGl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/commonlisp-QBdsjaTi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/crystal-B0kV858U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/css-lnqtDlV_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cypher-B_ciRc6O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/d-sGSUUdz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/diff-okFUO1eS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dtd-Covqp7FW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dylan-Bf_wFnkY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ecl-BON4bJzJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eiffel-CWbinnR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/elm-DKVclpIr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/erlang-D7Lapqoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/simple-mode-NsCUKpko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/factor-B2ESt4eh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/forth-CCfEYbe1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/fortran-ph1UcBiZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gas-BwHh1zIK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gherkin-a-S-92sq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/groovy-W6xB3OYy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haskell-DCE9UteQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haxe-CLcQehNU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/idl-VKcM9gU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/javascript-3wn7R2v8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mllike-BBifUJsv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/nsis-z1VCt9tx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pug-CaaLw7eE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/python-Dt99D71K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-BJLcBgU0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/objectWithoutPropertiesLoose-BhduYW5j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-DXZXojh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-C8_hvhi2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BwPQWTZk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/icons-DVWpV4I_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-missing-import-CgnlhMvv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/blob-BgGJeXvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-cell-with-ai-B5g8vtHB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-function-C7Ij9TAd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spec-D64rpvwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/focus-Bg0Cm8D6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useInstallPackage-CX-LUKF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/column-preview-CEDUFvMb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAddCell-C5hu4Wun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toggle-6a-IWcUo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/api-B8WZp3pa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globals-DlvGFwxH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/share-Cyx6Ke3B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4J1GeSh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utilities.esm-BUZA9ZNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/floating-outline-DJ1FXuVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eye-off-DNEZNQI7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/plus-VNKMcdhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/readonly-python-code-B1LohqR_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-video-camera-Bt4f7oOT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-text-KeEJTZsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-DU2hKpP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-CKcqkReK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/label-BnC8-64i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-x7Qa7Rrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textarea-faXBMy_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-ccw-Dmg0YI4-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-2-BsccpX3E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-CAATHPdC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/field-D6TVJZGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/switch-DBfU9QHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useBoolean-Do2iSPXV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeepCompareMemoize-DVzR9zu0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/LazyAnyLanguageCodeMirror-C5EeHVjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-BfF9hgo8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/prop-types-DVt2dPhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/es-Bve1w9dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/VisuallyHidden-BhVlvbgE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globe-DW6c4--m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/send-DjnZs47z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-cw-z53rVhjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/settings-Dt7V2Blo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/triangle-alert-DoSv9yQr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/bundle.esm-CC-LjhS-.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-CYOH-TAt.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "02_feature_engineering.py",
            "mode": "read",
            "version": "0.17.8",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "full", "reference_highlighting": false, "show_output": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "\"\"\"Setup path and import core libraries.\"\"\"\nimport sys\nfrom pathlib import Path\n# Add project root to path (works for both notebook and exported script)\ntry:\n    _file_path = Path(__file__).resolve()\nexcept NameError:\n    _file_path = Path.cwd() / \"notebooks\" / \"02_feature_engineering.py\"\n_project_root = _file_path.parent.parent\nif str(_project_root) not in sys.path:\n    sys.path.insert(0, str(_project_root))\n\nimport marimo as mo\nimport pandas as pd\nimport numpy as np\nfrom src.config import logger, CAMPAIGN_ROOT, FEATURES_DIR\nfrom src.features.feature_engineering import FeatureEngineeringUtils\nfrom src.features.docs import PipelineDocs", "code_hash": "bdde2f2cae09e077c6f208220100505d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "__"}, {"code": "\"\"\"Notebook title and introduction.\"\"\"\nmo.md(PipelineDocs.get_feature_engineering_intro())", "code_hash": "7a7337e6e807d8d4ee1c83ad2414018a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "__"}, {"code": "\"\"\"Load and validate annotated variants.\"\"\"\nfrom src.config import DEMO_MODE_ENABLED, ANNOTATIONS_DIR\n\n# Load annotated variants (fallback to scored variants if annotations not available)\nannotated_path = ANNOTATIONS_DIR / \"abca4_vus_annotated.parquet\"\nscored_path = FEATURES_DIR / \"variants_scored.parquet\"\nif not annotated_path.exists() or pd.read_parquet(annotated_path).empty:\n    # Fallback to scored variants if annotations not available\n    if scored_path.exists():\n        df_annotated = pd.read_parquet(scored_path)\n        logger.info(f\"Loaded {len(df_annotated)} variants from scored data (annotations not available)\")\n        mo.md(f\"\u2705 Loaded {len(df_annotated)} variants from scored data (annotations unavailable)\")\n    else:\n        mo.md(f\"\u274c Missing both annotated variants and scored variants\")\n        df_annotated = None\nelse:\n    df_annotated = pd.read_parquet(annotated_path)\n    logger.info(f\"Loaded {len(df_annotated)} annotated variants\")\n    mo.md(f\"\u2705 Loaded {len(df_annotated)} annotated variants successfully\")", "code_hash": "3fa8f373774cd19fac29472d2213ee4a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "__"}, {"code": "\"\"\"Data quality audit display.\"\"\"\nif df_annotated is None or df_annotated.empty:\n    mo.md(\"No data to audit.\")\nelse:\n    mo.md(PipelineDocs.get_data_quality_audit())\n\n# Basic stats\ntotal_vars = len(df_annotated)\nmo.md(f\"\"\"\n**Dataset Overview:**\n- Total variants: {total_vars:,}\n- Columns: {len(df_annotated.columns)}\n- Missing protein_change: {(df_annotated['protein_change'].isna().sum() / total_vars * 100):.1f}%\n\"\"\")", "code_hash": "94c75495432068554c1cdd00efaaa8e1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "__"}, {"code": "\"\"\"Load and merge all features using modular utilities.\"\"\"\nif df_annotated is None or df_annotated.empty:\n    mo.md(\"Cannot proceed without annotated variants.\")\n    df_scored_step3 = None\nelse:\n    # Define required feature slices\n    REQUIRED_FEATURE_SLICES = {\n        'missense': {\n            'path_relative': \"data_processed/features/missense_features.parquet\",\n            'computer_class': 'src.features.missense.MissenseFeatureComputer',\n            'required_columns': ['variant_id', 'alphamissense_score'],\n            'description': 'AlphaMissense + ESM features'\n        },\n        'splice': {\n            'path_relative': \"data_processed/features/splice_features.parquet\",\n            'computer_class': 'src.features.splice.SpliceFeatureComputer',\n            'required_columns': ['variant_id', 'spliceai_max_score'],\n            'description': 'SpliceAI features'\n        },\n        'conservation': {\n            'path_relative': \"data_processed/features/conservation_features.parquet\",\n            'computer_class': 'src.features.conservation.ConservationFeatureComputer',\n            'required_columns': ['variant_id', 'phyloP100way'],\n            'description': 'phyloP/phastCons conservation scores'\n        },\n        'regulatory': {\n            'path_relative': \"data_processed/features/regulatory_features.parquet\",\n            'computer_class': 'src.features.regulatory.RegulatoryFeatureComputer',\n            'required_columns': ['variant_id', 'gnomad_exome_af', 'gnomad_genome_af', 'gnomad_max_af'],\n            'description': 'domains + gnomAD regulatory features'\n        }\n    }\n\n    try:\n        # Use modular utility for feature loading and merging\n        feature_sources, status_summary = FeatureEngineeringUtils.load_or_compute_required_features(\n            REQUIRED_FEATURE_SLICES, CAMPAIGN_ROOT\n        )\n\n        # Use modular utility for merging with validation\n        df_scored_step3 = FeatureEngineeringUtils.merge_features_with_validation(\n            df_annotated, feature_sources, FEATURES_DIR\n        )\n\n        # Display status\n        mo.md(PipelineDocs.get_feature_status_template(status_summary.get('slices', {})))\n\n        # Display merge validation\n        merge_validation = df_scored_step3.attrs.get('merge_validation', [])\n        if merge_validation:\n            mo.md(\"**Merge Validation:**\")\n            mo.md(PipelineDocs.get_merge_validation_template(merge_validation))\n\n        # Display null rates\n        null_rates = df_scored_step3.attrs.get('null_rates', {})\n        if null_rates:\n            mo.md(\"**Data Quality (Non-Null Rates):**\")\n            mo.md(PipelineDocs.get_null_rates_template(null_rates))\n\n            min_pct = min(data.get('non_null_pct', 0) for data in null_rates.values())\n            if min_pct \u003E= 40:  # Adjusted threshold for AlphaMissense\n                mo.md(f\"\u2705 **All features meet quality thresholds** (minimum: {min_pct:.1f}%)\")\n            else:\n                mo.md(f\"\u274c **Quality check failed:** Some features below threshold\")\n\n        logger.info(f\"Feature engineering complete: {len(df_scored_step3)} variants\")\n\n    except Exception as e:\n        mo.md(f\"\u274c Feature engineering failed: {e}\")\n        logger.error(f\"Feature engineering error: {e}\")\n        df_scored_step3 = None", "code_hash": "f71bece51cb4f6fac690ff4f99488a67", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "__"}, {"code": "\"\"\"Impact scoring section introduction.\"\"\"\nmo.md(PipelineDocs.get_impact_scoring_intro())", "code_hash": "5715bd2051e62e881d50c36e7dd1bfaf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "__"}, {"code": "\"\"\"Compute impact scores using modular utilities.\"\"\"\nif df_scored_step3 is None or df_scored_step3.empty:\n    mo.md(\"Cannot compute impact scores without features.\")\n    df_impact = None\nelse:\n    try:\n        # Use modular utility for impact scoring\n        df_impact = FeatureEngineeringUtils.compute_impact_scores(\n            df_scored_step3,\n            scoring_mode=\"hand-mix\",\n            features_dir=FEATURES_DIR\n        )\n\n        # Check for errors\n        scoring_error = df_impact.attrs.get('scoring_error')\n        if scoring_error:\n            mo.md(f\"\u26a0\ufe0f Scoring warning: {scoring_error}\")\n        else:\n            mo.md(\"\u2705 Impact scores computed successfully\")\n\n        # Display basic stats\n        impact_range = df_impact['impact_score'].agg(['min', 'max'])\n        mo.md(f\"\"\"\n**Impact Score Statistics:**\n- Range: {impact_range['min']:.3f} - {impact_range['max']:.3f}\n- Mean: {df_impact['impact_score'].mean():.3f}\n- Domain flag distribution: {df_impact['domain_flag'].value_counts().to_dict()}\n\"\"\")\n\n        # Save intermediate results\n        features_raw_path = FEATURES_DIR / \"variants_features_raw.parquet\"\n        df_impact.to_parquet(features_raw_path)\n        logger.info(f\"Saved intermediate features to {features_raw_path}\")\n\n    except Exception as e:\n        mo.md(f\"\u274c Impact scoring failed: {e}\")\n        logger.error(f\"Impact scoring error: {e}\")\n        df_impact = None", "code_hash": "72883fe4fd0a843311ea3422618c4e4c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "__"}, {"code": "\"\"\"QC plots for impact score validation.\"\"\"\nif df_impact is None or df_impact.empty:\n    mo.md(\"Cannot create QC plots without impact scores.\")\nelse:\n    # Use modular utility for QC plots\n    fig_qc, fig_domain = FeatureEngineeringUtils.create_qc_plots(df_impact)\n\n    if fig_qc:\n        mo.ui.plotly(fig_qc)\n    else:\n        mo.md(\"\u274c Could not generate P/LP vs B/LB QC plot\")\n\n    if fig_domain:\n        mo.ui.plotly(fig_domain)\n    else:\n        mo.md(\"\u274c Could not generate domain-based QC plot\")", "code_hash": "12ce4043905810e776f428eb4086c2de", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "__"}, {"code": "\"\"\"Clustering section introduction.\"\"\"\nmo.md(PipelineDocs.get_clustering_intro())", "code_hash": "10d321256ac792e263d59d1b53a87237", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "__"}, {"code": "\"\"\"Apply clustering using modular utilities.\"\"\"\ndf_clusters = None\nif df_impact is None or df_impact.empty:\n    mo.md(\"Cannot perform clustering without impact scores.\")\nelse:\n    try:\n        from src.features.add_clustering import ClusteringProcessor\n\n        # Apply domain boost and clustering\n        processor = ClusteringProcessor()\n\n        # Apply domain boost\n        df_boosted = processor.apply_domain_boost(df_impact)\n\n        # Apply hotspot overrides\n        df_overridden = processor.apply_hotspot_overrides(df_boosted)\n\n        # Assign clusters using domain-based approach\n        df_clustered = processor.assign_clusters_domain(df_overridden)\n\n        # Compute biology-aware targets\n        df_with_targets = processor.compute_cluster_targets_biology_aware(df_clustered)\n\n        # Compute coverage\n        df_clusters = processor.compute_cluster_coverage(df_with_targets)\n\n        # Preserve metadata attributes from original dataframe\n        df_clusters.attrs.update(df_impact.attrs)\n\n        # Display summary\n        mo.md(PipelineDocs.get_cluster_summary_template(df_clusters))\n\n        # Save clustered variants directly to preserve attributes\n        scored_path = FEATURES_DIR / \"variants_scored.parquet\"\n        csv_path = FEATURES_DIR / \"variants_scored.csv\"\n\n        try:\n            df_clusters.to_parquet(scored_path, index=False)\n            df_clusters.to_csv(csv_path, index=False)\n            logger.info(f\"Saved {len(df_clusters)} clustered variants with {len(df_clusters.attrs)} attributes to {scored_path}\")\n\n            # Log cluster summary\n            if \"cluster_id\" in df_clusters.columns:\n                cluster_counts = df_clusters[\"cluster_id\"].value_counts()\n                logger.info(f\"Cluster distribution:\\\\n{cluster_counts}\")\n\n        except Exception as e:\n            logger.error(f\"Failed to save clustered variants: {e}\")\n            mo.md(f\"\u274c Failed to save results: {e}\")\n\n        logger.info(f\"Clustering complete: {df_clusters['cluster_id'].nunique()} clusters\")\n\n    except Exception as e:\n        mo.md(f\"\u274c Clustering failed: {e}\")\n        logger.error(f\"Clustering error: {e}\")\n        df_clusters = None", "code_hash": "5a02b9aa07ea78401aec864ce5ac5fc9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "__"}, {"code": "\"\"\"Save final clustered and scored variants.\"\"\"\nif df_clusters is None:\n    mo.md(\"Cannot save results without clustered data.\")\nelse:\n    try:\n        # Save to variants_scored.parquet\n        _scored_path = FEATURES_DIR / \"variants_scored.parquet\"\n        df_clusters.to_parquet(_scored_path)\n\n        # Save CSV version\n        _csv_path = FEATURES_DIR / \"variants_scored.csv\"\n        df_clusters.to_csv(_csv_path, index=False)\n\n        mo.md(f\"\"\"\n\u2705 **Pipeline Complete!**\n\n**Outputs saved:**\n- `variants_scored.parquet/csv`: {len(df_clusters)} clustered variants\n- `variants_features_raw.parquet`: Intermediate features with impact scores\n\n**Ready for optimization in next notebook.**\n\"\"\")\n\n    except Exception as e:\n        mo.md(f\"\u274c Failed to save results: {e}\")", "code_hash": "bf2b0a6eb854a5dd3b540dd65394a4fc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "__"}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "bdde2f2cae09e077c6f208220100505d", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7a7337e6e807d8d4ee1c83ad2414018a", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"abca4-variant-analysis-feature-engineering\"\u003EABCA4 Variant Analysis: Feature Engineering\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EThis notebook loads and processes genetic variant features for ABCA4, the gene associated with Stargardt disease.\u003C/span\u003E\n\u003Ch2 id=\"pipeline-overview\"\u003EPipeline Overview\u003C/h2\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Cstrong\u003ELoad annotated variants\u003C/strong\u003E from ClinVar VUS dataset\u003C/li\u003E\n\u003Cli\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ECompute/combine features\u003C/strong\u003E from multiple sources:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EAlphaMissense (missense prediction)\u003C/li\u003E\n\u003Cli\u003ESpliceAI (splice disruption)\u003C/li\u003E\n\u003Cli\u003EConservation scores (phyloP)\u003C/li\u003E\n\u003Cli\u003EPopulation frequencies (gnomAD)\u003C/li\u003E\n\u003Cli\u003EProtein domain assignments\u003C/li\u003E\n\u003C/ul\u003E\n\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EQuality validation\u003C/strong\u003E and null rate checking\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EImpact score computation\u003C/strong\u003E with domain-aware weighting\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EExport\u003C/strong\u003E for downstream optimization\u003C/li\u003E\n\u003C/ol\u003E\n\u003Ch2 id=\"key-outputs\"\u003EKey Outputs\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Evariants_features_raw.parquet\u003C/code\u003E: All features with impact scores\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Evariants_scored.parquet\u003C/code\u003E: Clustered variants with coverage targets\u003C/li\u003E\n\u003Cli\u003EQC plots and validation metrics\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3fa8f373774cd19fac29472d2213ee4a", "console": [], "id": "vblA", "outputs": [{"ename": "multiple-defs", "evalue": "The variable 'scored_path' was defined by another cell", "traceback": [], "type": "error"}]}, {"code_hash": "94c75495432068554c1cdd00efaaa8e1", "console": [{"mimetype": "application/vnd.marimo+traceback", "name": "stderr", "text": "\u003Cspan class=\"codehilite\"\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Cspan class=\"gt\"\u003ETraceback (most recent call last):\u003C/span\u003E\n  File \u003Cspan class=\"nb\"\u003E\u0026quot;/var/folders/9c/r4lvzcp94tq11jltww87ghmh0000gn/T/marimo_55328/__marimo__cell_bkHC_.py\u0026quot;\u003C/span\u003E, line \u003Cspan class=\"m\"\u003E2\u003C/span\u003E, in \u003Cspan class=\"n\"\u003E\u0026lt;module\u0026gt;\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"n\"\u003Edf_annotated\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eis\u003C/span\u003E \u003Cspan class=\"kc\"\u003ENone\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eor\u003C/span\u003E \u003Cspan class=\"n\"\u003Edf_annotated\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eempty\u003C/span\u003E\u003Cspan class=\"p\"\u003E:\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E       \u003C/span\u003E\u003Cspan class=\"pm\"\u003E^^^^^^^^^^^^\u003C/span\u003E\n\u003Cspan class=\"gr\"\u003ENameError\u003C/span\u003E: \u003Cspan class=\"n\"\u003Ename \u0026#39;df_annotated\u0026#39; is not defined\u003C/span\u003E\n\u003C/pre\u003E\u003C/div\u003E\n\u003C/span\u003E", "type": "stream"}], "id": "bkHC", "outputs": [{"ename": "exception", "evalue": "Name `df_annotated` is not defined. It was expected to be defined in ", "traceback": [], "type": "error"}]}, {"code_hash": "f71bece51cb4f6fac690ff4f99488a67", "console": [{"mimetype": "application/vnd.marimo+traceback", "name": "stderr", "text": "\u003Cspan class=\"codehilite\"\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Cspan class=\"gt\"\u003ETraceback (most recent call last):\u003C/span\u003E\n  File \u003Cspan class=\"nb\"\u003E\u0026quot;/var/folders/9c/r4lvzcp94tq11jltww87ghmh0000gn/T/marimo_55328/__marimo__cell_lEQa_.py\u0026quot;\u003C/span\u003E, line \u003Cspan class=\"m\"\u003E2\u003C/span\u003E, in \u003Cspan class=\"n\"\u003E\u0026lt;module\u0026gt;\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E    \u003C/span\u003E\u003Cspan class=\"k\"\u003Eif\u003C/span\u003E \u003Cspan class=\"n\"\u003Edf_annotated\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eis\u003C/span\u003E \u003Cspan class=\"kc\"\u003ENone\u003C/span\u003E \u003Cspan class=\"ow\"\u003Eor\u003C/span\u003E \u003Cspan class=\"n\"\u003Edf_annotated\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Eempty\u003C/span\u003E\u003Cspan class=\"p\"\u003E:\u003C/span\u003E\n\u003Cspan class=\"w\"\u003E       \u003C/span\u003E\u003Cspan class=\"pm\"\u003E^^^^^^^^^^^^\u003C/span\u003E\n\u003Cspan class=\"gr\"\u003ENameError\u003C/span\u003E: \u003Cspan class=\"n\"\u003Ename \u0026#39;df_annotated\u0026#39; is not defined\u003C/span\u003E\n\u003C/pre\u003E\u003C/div\u003E\n\u003C/span\u003E", "type": "stream"}], "id": "lEQa", "outputs": [{"ename": "exception", "evalue": "Name `df_annotated` is not defined. It was expected to be defined in ", "traceback": [], "type": "error"}]}, {"code_hash": "5715bd2051e62e881d50c36e7dd1bfaf", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"step-4-impact-score-construction\"\u003EStep 4: Impact Score Construction\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ECombine multiple signals into a unified impact score for variant prioritization.\u003C/span\u003E\n\u003Ch3 id=\"scoring-formula\"\u003EScoring Formula\u003C/h3\u003E\n\u003Cdiv class=\"language-scdoc codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003Eimpact_score = 0.6 \u00d7 model_score +\n               0.2 \u00d7 cons_scaled +\n               0.1 \u00d7 domain_flag +\n               0.1 \u00d7 splice_prox_flag -\n               0.3 \u00d7 af_penalty\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Ch3 id=\"component-explanations\"\u003EComponent Explanations\u003C/h3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Emodel_score\u003C/strong\u003E: AlphaMissense/SpliceAI/conservation weighted combination\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Econs_scaled\u003C/strong\u003E: Normalized phyloP conservation score (0-1)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Edomain_flag\u003C/strong\u003E: 1 if variant falls in defined protein domain\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Esplice_prox_flag\u003C/strong\u003E: 1 if splice-related consequence or near exon boundary\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eaf_penalty\u003C/strong\u003E: Monotonic penalty for common variants (rarity bonus)\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "72883fe4fd0a843311ea3422618c4e4c", "console": [], "id": "Xref", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (MarimoExceptionRaisedError): ", "traceback": [], "type": "error"}]}, {"code_hash": "12ce4043905810e776f428eb4086c2de", "console": [], "id": "SFPL", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (MarimoExceptionRaisedError): ", "traceback": [], "type": "error"}]}, {"code_hash": "10d321256ac792e263d59d1b53a87237", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"step-5-clustering-coverage-targets\"\u003EStep 5: Clustering \u0026amp; Coverage Targets\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EGroup variants by biological mechanism and compute coverage thresholds.\u003C/span\u003E\n\u003Ch3 id=\"clustering-strategy\"\u003EClustering Strategy\u003C/h3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EPrimary grouping\u003C/strong\u003E: Protein domain (NBD1, NBD2, TMD1, TMD2, CTD)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ESub-clustering\u003C/strong\u003E: By consequence within large domains\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EFallback\u003C/strong\u003E: Consequence-based clustering if domains unavailable\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch3 id=\"coverage-targets-j\"\u003ECoverage Targets (\u03c4\u2c7c)\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EBiology-aware thresholds computed as:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EWith clinical data\u003C/strong\u003E: Median impact_score of P/LP variants in cluster\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EWithout clinical data\u003C/strong\u003E: 70th percentile of cluster scores (capped at 0.9)\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5a02b9aa07ea78401aec864ce5ac5fc9", "console": [], "id": "RGSE", "outputs": [{"ename": "multiple-defs", "evalue": "The variable 'scored_path' was defined by another cell", "traceback": [], "type": "error"}]}, {"code_hash": "bf2b0a6eb854a5dd3b540dd65394a4fc", "console": [], "id": "Kclp", "outputs": [{"ename": "exception", "evalue": "An ancestor raised an exception (MarimoExceptionRaisedError): ", "traceback": [], "type": "error"}]}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.8%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%22%22%22Setup%20path%20and%20import%20core%20libraries.%22%22%22%0A%20%20%20%20import%20sys%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20%23%20Add%20project%20root%20to%20path%20(works%20for%20both%20notebook%20and%20exported%20script)%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path(__file__).resolve()%0A%20%20%20%20except%20NameError%3A%0A%20%20%20%20%20%20%20%20_file_path%20%3D%20Path.cwd()%20%2F%20%22notebooks%22%20%2F%20%2202_feature_engineering.py%22%0A%20%20%20%20_project_root%20%3D%20_file_path.parent.parent%0A%20%20%20%20if%20str(_project_root)%20not%20in%20sys.path%3A%0A%20%20%20%20%20%20%20%20sys.path.insert(0%2C%20str(_project_root))%0A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20from%20src.config%20import%20logger%2C%20CAMPAIGN_ROOT%2C%20FEATURES_DIR%0A%20%20%20%20from%20src.features.feature_engineering%20import%20FeatureEngineeringUtils%0A%20%20%20%20from%20src.features.docs%20import%20PipelineDocs%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20CAMPAIGN_ROOT%2C%0A%20%20%20%20%20%20%20%20FEATURES_DIR%2C%0A%20%20%20%20%20%20%20%20FeatureEngineeringUtils%2C%0A%20%20%20%20%20%20%20%20PipelineDocs%2C%0A%20%20%20%20%20%20%20%20logger%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20mo)%3A%0A%20%20%20%20%22%22%22Notebook%20title%20and%20introduction.%22%22%22%0A%20%20%20%20mo.md(PipelineDocs.get_feature_engineering_intro())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(FEATURES_DIR%2C%20logger%2C%20mo%2C%20pd)%3A%0A%20%20%20%20%22%22%22Load%20and%20validate%20annotated%20variants.%22%22%22%0A%20%20%20%20from%20src.config%20import%20DEMO_MODE_ENABLED%2C%20ANNOTATIONS_DIR%0A%0A%20%20%20%20%23%20Load%20annotated%20variants%20(fallback%20to%20scored%20variants%20if%20annotations%20not%20available)%0A%20%20%20%20annotated_path%20%3D%20ANNOTATIONS_DIR%20%2F%20%22abca4_vus_annotated.parquet%22%0A%20%20%20%20scored_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.parquet%22%0A%20%20%20%20if%20not%20annotated_path.exists()%20or%20pd.read_parquet(annotated_path).empty%3A%0A%20%20%20%20%20%20%20%20%23%20Fallback%20to%20scored%20variants%20if%20annotations%20not%20available%0A%20%20%20%20%20%20%20%20if%20scored_path.exists()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_annotated%20%3D%20pd.read_parquet(scored_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_annotated)%7D%20variants%20from%20scored%20data%20(annotations%20not%20available)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20Loaded%20%7Blen(df_annotated)%7D%20variants%20from%20scored%20data%20(annotations%20unavailable)%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Missing%20both%20annotated%20variants%20and%20scored%20variants%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_annotated%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20df_annotated%20%3D%20pd.read_parquet(annotated_path)%0A%20%20%20%20%20%20%20%20logger.info(f%22Loaded%20%7Blen(df_annotated)%7D%20annotated%20variants%22)%0A%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20Loaded%20%7Blen(df_annotated)%7D%20annotated%20variants%20successfully%22)%0A%20%20%20%20return%20(df_annotated%2C)%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20df_annotated%2C%20mo)%3A%0A%20%20%20%20%22%22%22Data%20quality%20audit%20display.%22%22%22%0A%20%20%20%20if%20df_annotated%20is%20None%20or%20df_annotated.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22No%20data%20to%20audit.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_data_quality_audit())%0A%0A%20%20%20%20%23%20Basic%20stats%0A%20%20%20%20total_vars%20%3D%20len(df_annotated)%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Dataset%20Overview%3A**%0A%20%20%20%20-%20Total%20variants%3A%20%7Btotal_vars%3A%2C%7D%0A%20%20%20%20-%20Columns%3A%20%7Blen(df_annotated.columns)%7D%0A%20%20%20%20-%20Missing%20protein_change%3A%20%7B(df_annotated%5B'protein_change'%5D.isna().sum()%20%2F%20total_vars%20*%20100)%3A.1f%7D%25%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20CAMPAIGN_ROOT%2C%0A%20%20%20%20FEATURES_DIR%2C%0A%20%20%20%20FeatureEngineeringUtils%2C%0A%20%20%20%20PipelineDocs%2C%0A%20%20%20%20df_annotated%2C%0A%20%20%20%20logger%2C%0A%20%20%20%20mo%2C%0A)%3A%0A%20%20%20%20%22%22%22Load%20and%20merge%20all%20features%20using%20modular%20utilities.%22%22%22%0A%20%20%20%20if%20df_annotated%20is%20None%20or%20df_annotated.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20proceed%20without%20annotated%20variants.%22)%0A%20%20%20%20%20%20%20%20df_scored_step3%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Define%20required%20feature%20slices%0A%20%20%20%20%20%20%20%20REQUIRED_FEATURE_SLICES%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20'missense'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path_relative'%3A%20%22data_processed%2Ffeatures%2Fmissense_features.parquet%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'computer_class'%3A%20'src.features.missense.MissenseFeatureComputer'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'required_columns'%3A%20%5B'variant_id'%2C%20'alphamissense_score'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'description'%3A%20'AlphaMissense%20%2B%20ESM%20features'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'splice'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path_relative'%3A%20%22data_processed%2Ffeatures%2Fsplice_features.parquet%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'computer_class'%3A%20'src.features.splice.SpliceFeatureComputer'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'required_columns'%3A%20%5B'variant_id'%2C%20'spliceai_max_score'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'description'%3A%20'SpliceAI%20features'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'conservation'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path_relative'%3A%20%22data_processed%2Ffeatures%2Fconservation_features.parquet%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'computer_class'%3A%20'src.features.conservation.ConservationFeatureComputer'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'required_columns'%3A%20%5B'variant_id'%2C%20'phyloP100way'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'description'%3A%20'phyloP%2FphastCons%20conservation%20scores'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'regulatory'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path_relative'%3A%20%22data_processed%2Ffeatures%2Fregulatory_features.parquet%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'computer_class'%3A%20'src.features.regulatory.RegulatoryFeatureComputer'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'required_columns'%3A%20%5B'variant_id'%2C%20'gnomad_exome_af'%2C%20'gnomad_genome_af'%2C%20'gnomad_max_af'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'description'%3A%20'domains%20%2B%20gnomAD%20regulatory%20features'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Use%20modular%20utility%20for%20feature%20loading%20and%20merging%0A%20%20%20%20%20%20%20%20%20%20%20%20feature_sources%2C%20status_summary%20%3D%20FeatureEngineeringUtils.load_or_compute_required_features(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20REQUIRED_FEATURE_SLICES%2C%20CAMPAIGN_ROOT%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Use%20modular%20utility%20for%20merging%20with%20validation%0A%20%20%20%20%20%20%20%20%20%20%20%20df_scored_step3%20%3D%20FeatureEngineeringUtils.merge_features_with_validation(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_annotated%2C%20feature_sources%2C%20FEATURES_DIR%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Display%20status%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_feature_status_template(status_summary.get('slices'%2C%20%7B%7D)))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Display%20merge%20validation%0A%20%20%20%20%20%20%20%20%20%20%20%20merge_validation%20%3D%20df_scored_step3.attrs.get('merge_validation'%2C%20%5B%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20merge_validation%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Merge%20Validation%3A**%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_merge_validation_template(merge_validation))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Display%20null%20rates%0A%20%20%20%20%20%20%20%20%20%20%20%20null_rates%20%3D%20df_scored_step3.attrs.get('null_rates'%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20null_rates%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Data%20Quality%20(Non-Null%20Rates)%3A**%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_null_rates_template(null_rates))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min_pct%20%3D%20min(data.get('non_null_pct'%2C%200)%20for%20data%20in%20null_rates.values())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20min_pct%20%3E%3D%2040%3A%20%20%23%20Adjusted%20threshold%20for%20AlphaMissense%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20**All%20features%20meet%20quality%20thresholds**%20(minimum%3A%20%7Bmin_pct%3A.1f%7D%25)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20**Quality%20check%20failed%3A**%20Some%20features%20below%20threshold%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Feature%20engineering%20complete%3A%20%7Blen(df_scored_step3)%7D%20variants%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Feature%20engineering%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Feature%20engineering%20error%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_scored_step3%20%3D%20None%0A%20%20%20%20return%20(df_scored_step3%2C)%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20mo)%3A%0A%20%20%20%20%22%22%22Impact%20scoring%20section%20introduction.%22%22%22%0A%20%20%20%20mo.md(PipelineDocs.get_impact_scoring_intro())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(FEATURES_DIR%2C%20FeatureEngineeringUtils%2C%20df_scored_step3%2C%20logger%2C%20mo)%3A%0A%20%20%20%20%22%22%22Compute%20impact%20scores%20using%20modular%20utilities.%22%22%22%0A%20%20%20%20if%20df_scored_step3%20is%20None%20or%20df_scored_step3.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20compute%20impact%20scores%20without%20features.%22)%0A%20%20%20%20%20%20%20%20df_impact%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Use%20modular%20utility%20for%20impact%20scoring%0A%20%20%20%20%20%20%20%20%20%20%20%20df_impact%20%3D%20FeatureEngineeringUtils.compute_impact_scores(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_scored_step3%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scoring_mode%3D%22hand-mix%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20features_dir%3DFEATURES_DIR%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20for%20errors%0A%20%20%20%20%20%20%20%20%20%20%20%20scoring_error%20%3D%20df_impact.attrs.get('scoring_error')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20scoring_error%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9A%A0%EF%B8%8F%20Scoring%20warning%3A%20%7Bscoring_error%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9C%85%20Impact%20scores%20computed%20successfully%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Display%20basic%20stats%0A%20%20%20%20%20%20%20%20%20%20%20%20impact_range%20%3D%20df_impact%5B'impact_score'%5D.agg(%5B'min'%2C%20'max'%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20**Impact%20Score%20Statistics%3A**%0A%20%20%20%20-%20Range%3A%20%7Bimpact_range%5B'min'%5D%3A.3f%7D%20-%20%7Bimpact_range%5B'max'%5D%3A.3f%7D%0A%20%20%20%20-%20Mean%3A%20%7Bdf_impact%5B'impact_score'%5D.mean()%3A.3f%7D%0A%20%20%20%20-%20Domain%20flag%20distribution%3A%20%7Bdf_impact%5B'domain_flag'%5D.value_counts().to_dict()%7D%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Save%20intermediate%20results%0A%20%20%20%20%20%20%20%20%20%20%20%20features_raw_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_features_raw.parquet%22%0A%20%20%20%20%20%20%20%20%20%20%20%20df_impact.to_parquet(features_raw_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Saved%20intermediate%20features%20to%20%7Bfeatures_raw_path%7D%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Impact%20scoring%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Impact%20scoring%20error%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_impact%20%3D%20None%0A%20%20%20%20return%20(df_impact%2C)%0A%0A%0A%40app.cell%0Adef%20_(FeatureEngineeringUtils%2C%20df_impact%2C%20mo)%3A%0A%20%20%20%20%22%22%22QC%20plots%20for%20impact%20score%20validation.%22%22%22%0A%20%20%20%20if%20df_impact%20is%20None%20or%20df_impact.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20create%20QC%20plots%20without%20impact%20scores.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Use%20modular%20utility%20for%20QC%20plots%0A%20%20%20%20%20%20%20%20fig_qc%2C%20fig_domain%20%3D%20FeatureEngineeringUtils.create_qc_plots(df_impact)%0A%0A%20%20%20%20%20%20%20%20if%20fig_qc%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.plotly(fig_qc)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9D%8C%20Could%20not%20generate%20P%2FLP%20vs%20B%2FLB%20QC%20plot%22)%0A%0A%20%20%20%20%20%20%20%20if%20fig_domain%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.plotly(fig_domain)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9D%8C%20Could%20not%20generate%20domain-based%20QC%20plot%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PipelineDocs%2C%20mo)%3A%0A%20%20%20%20%22%22%22Clustering%20section%20introduction.%22%22%22%0A%20%20%20%20mo.md(PipelineDocs.get_clustering_intro())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(FEATURES_DIR%2C%20PipelineDocs%2C%20df_impact%2C%20logger%2C%20mo)%3A%0A%20%20%20%20%22%22%22Apply%20clustering%20using%20modular%20utilities.%22%22%22%0A%20%20%20%20df_clusters%20%3D%20None%0A%20%20%20%20if%20df_impact%20is%20None%20or%20df_impact.empty%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20perform%20clustering%20without%20impact%20scores.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20from%20src.features.add_clustering%20import%20ClusteringProcessor%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Apply%20domain%20boost%20and%20clustering%0A%20%20%20%20%20%20%20%20%20%20%20%20processor%20%3D%20ClusteringProcessor()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Apply%20domain%20boost%0A%20%20%20%20%20%20%20%20%20%20%20%20df_boosted%20%3D%20processor.apply_domain_boost(df_impact)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Apply%20hotspot%20overrides%0A%20%20%20%20%20%20%20%20%20%20%20%20df_overridden%20%3D%20processor.apply_hotspot_overrides(df_boosted)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Assign%20clusters%20using%20domain-based%20approach%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clustered%20%3D%20processor.assign_clusters_domain(df_overridden)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Compute%20biology-aware%20targets%0A%20%20%20%20%20%20%20%20%20%20%20%20df_with_targets%20%3D%20processor.compute_cluster_targets_biology_aware(df_clustered)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Compute%20coverage%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clusters%20%3D%20processor.compute_cluster_coverage(df_with_targets)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Preserve%20metadata%20attributes%20from%20original%20dataframe%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clusters.attrs.update(df_impact.attrs)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Display%20summary%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(PipelineDocs.get_cluster_summary_template(df_clusters))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Save%20clustered%20variants%20directly%20to%20preserve%20attributes%0A%20%20%20%20%20%20%20%20%20%20%20%20scored_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.parquet%22%0A%20%20%20%20%20%20%20%20%20%20%20%20csv_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.csv%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_clusters.to_parquet(scored_path%2C%20index%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df_clusters.to_csv(csv_path%2C%20index%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Saved%20%7Blen(df_clusters)%7D%20clustered%20variants%20with%20%7Blen(df_clusters.attrs)%7D%20attributes%20to%20%7Bscored_path%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Log%20cluster%20summary%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%22cluster_id%22%20in%20df_clusters.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cluster_counts%20%3D%20df_clusters%5B%22cluster_id%22%5D.value_counts()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Cluster%20distribution%3A%5C%5Cn%7Bcluster_counts%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Failed%20to%20save%20clustered%20variants%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Failed%20to%20save%20results%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.info(f%22Clustering%20complete%3A%20%7Bdf_clusters%5B'cluster_id'%5D.nunique()%7D%20clusters%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Clustering%20failed%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20logger.error(f%22Clustering%20error%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clusters%20%3D%20None%0A%20%20%20%20return%20(df_clusters%2C)%0A%0A%0A%40app.cell%0Adef%20_(FEATURES_DIR%2C%20df_clusters%2C%20mo)%3A%0A%20%20%20%20%22%22%22Save%20final%20clustered%20and%20scored%20variants.%22%22%22%0A%20%20%20%20if%20df_clusters%20is%20None%3A%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20save%20results%20without%20clustered%20data.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Save%20to%20variants_scored.parquet%0A%20%20%20%20%20%20%20%20%20%20%20%20_scored_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.parquet%22%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clusters.to_parquet(_scored_path)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Save%20CSV%20version%0A%20%20%20%20%20%20%20%20%20%20%20%20_csv_path%20%3D%20FEATURES_DIR%20%2F%20%22variants_scored.csv%22%0A%20%20%20%20%20%20%20%20%20%20%20%20df_clusters.to_csv(_csv_path%2C%20index%3DFalse)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20%E2%9C%85%20**Pipeline%20Complete!**%0A%0A%20%20%20%20**Outputs%20saved%3A**%0A%20%20%20%20-%20%60variants_scored.parquet%2Fcsv%60%3A%20%7Blen(df_clusters)%7D%20clustered%20variants%0A%20%20%20%20-%20%60variants_features_raw.parquet%60%3A%20Intermediate%20features%20with%20impact%20scores%0A%0A%20%20%20%20**Ready%20for%20optimization%20in%20next%20notebook.**%0A%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9D%8C%20Failed%20to%20save%20results%3A%20%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">5dda0bcbc200e0b967a6eb1bf2e3c761</marimo-code-hash>
</body>
</html>
