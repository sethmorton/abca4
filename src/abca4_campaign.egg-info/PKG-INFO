Metadata-Version: 2.4
Name: abca4-campaign
Version: 0.1.0
Summary: ABCA4 variant triage campaign (notebooks + pipeline)
Author: ABCA4 Team
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: pandas>=2.1
Requires-Dist: numpy<2.0,>=1.26
Requires-Dist: scipy>=1.12
Requires-Dist: requests>=2.31.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: biopython>=1.81
Requires-Dist: pysam>=0.23.3
Requires-Dist: pyensembl>=2.2
Requires-Dist: mlflow>=2.14
Requires-Dist: marimo[recommended]>=0.17.8
Requires-Dist: plotly>=6.4.0
Provides-Extra: interactive
Requires-Dist: marimo>=0.17.8; extra == "interactive"
Requires-Dist: plotly>=5.15.0; extra == "interactive"

# ğŸ§¬ ABCA4 Variant Intelligence Campaign

This folder contains an end-to-end rare-variant intelligence pipeline for ABCA4, a gene involved in Stargardt macular degeneration. The campaign is completely self-contained so the main `strand-sdk` framework remains clean and reusable for other campaigns.

## ğŸ“‚ Folder Structure

```
campaigns/abca4/
â”œâ”€â”€ notebooks/                # Interactive Marimo analysis notebooks
â”‚   â”œâ”€â”€ 01_data_exploration.py          - Data discovery & filtering
â”‚   â”œâ”€â”€ 02_feature_engineering.py       - Feature computation & tuning  
â”‚   â”œâ”€â”€ 03_optimization_dashboard.py    - Results analysis & visualization
â”‚   â””â”€â”€ 04_fasta_exploration.py         - Sequence analysis & motif detection
â”œâ”€â”€ src/                      # Reusable pipeline modules
â”‚   â”œâ”€â”€ data/                 - Download & preprocessing scripts
â”‚   â”œâ”€â”€ features/             - Feature computation (conservation, splice, etc)
â”‚   â”œâ”€â”€ annotation/           - Transcript & domain annotation
â”‚   â””â”€â”€ reporting/            - Report generation
â”œâ”€â”€ docs/                     # Research notes & documentation
â”œâ”€â”€ data_raw/                 # Original data sources (git-ignored)
â”œâ”€â”€ data_processed/           # Computed outputs (git-ignored)
â”œâ”€â”€ requirements.txt          # Campaign dependencies
â”œâ”€â”€ tasks.py                  # Invoke task automation
â””â”€â”€ .marimo.toml             # Marimo configuration (light theme, uv package manager)
```

## ğŸš€ Quick Start

### Setup (UV Package Manager)

This project uses **`uv`** for fast, isolated Python dependency management and **`marimo`** for interactive notebooks.

**System Requirements:** Only `uv` is needed. All 127 Python dependencies have prebuilt wheels for Python 3.12 on macOS/Linux/Windows, so no system libraries (gcc, build tools, etc.) are required.

**Why Python 3.12?** PyArrow (via MLflow) doesn't have prebuilt wheels for Python 3.14 or early 3.13 on macOS ARM64. Without prebuilt wheels, it attempts to build from source, requiring system-level Apache Arrow C++ libraries. Python 3.12 has stable precompiled wheels, so everything installs instantly.

```bash
# Install all dependencies (including optional extras for marimo & plotly)
uv sync --all-extras

# Verify all notebooks
for nb in notebooks/*.py; do uv run marimo check "$nb"; done
```

**What gets installed:**
- âœ“ NumPy, Pandas, SciPy â€” data science
- âœ“ BioPython, PySAM, PyEnsembl â€” bioinformatics
- âœ“ MLflow, requests, PyYAML â€” utilities
- âœ“ Marimo, Plotly â€” interactive notebooks & visualization
- âœ— No system dependencies needed

### Running Invoke Tasks

Run tasks from the repo root:

```bash
invoke -l                        # list all available tasks
invoke download-data             # fetch ClinVar/gnomAD/SpliceAI/AlphaMissense
invoke run-pipeline              # execute full feature computation pipeline
invoke run-optimization          # rank variants & log to MLflow
invoke generate-report           # generate snapshot reports
```

### Interactive Notebooks

Edit notebooks interactively:

```bash
uv run marimo edit notebooks/01_data_exploration.py
uv run marimo edit notebooks/02_feature_engineering.py
uv run marimo edit notebooks/03_optimization_dashboard.py
uv run marimo edit notebooks/04_fasta_exploration.py
```

### Running Notebooks as Dashboards

Deploy as standalone interactive dashboards:

```bash
uv run marimo run notebooks/01_data_exploration.py --headless
uv run marimo run notebooks/03_optimization_dashboard.py --headless
```

### Running Notebooks as Scripts

Execute notebooks as Python scripts with CLI arguments:

```bash
uv run python notebooks/01_data_exploration.py
```

## ğŸ“Š Notebook Guide

| Notebook | Purpose | Use Case |
|----------|---------|----------|
| **01_data_exploration.py** | Interactive data filtering & summary statistics | Explore raw variants, apply filters, see distribution plots |
| **02_feature_engineering.py** | Feature computation & weight tuning | Experiment with feature combinations, visualize importance |
| **03_optimization_dashboard.py** | Results visualization & comparison | View optimization progress, analyze sensitivity, compare methods |
| **04_fasta_exploration.py** | Sequence analysis | Find motifs, explore protein structure, sequence patterns |

## ğŸ”¬ Pipeline Flow

```
data_raw/                    Download raw data (ClinVar, gnomAD, etc)
    â†“
src/data/                    Preprocess & filter variants
    â†“
src/features/                Compute features (conservation, splice, missense)
    â†“
data_processed/features/     Store feature matrix
    â†“
notebooks/                   Explore & optimize with interactive dashboards
    â†“
data_processed/reports/      Export top variants & reports
```

## âš™ï¸ Configuration

The `.marimo.toml` file configures:
- **Theme**: Light (optimized for data visualization readability)
- **Runtime**: Lazy evaluation (cells run only when outputs needed)
- **Package Manager**: uv (fast Python package management)
- **Formatting**: Auto-format on save with Ruff

## ğŸ”— Resources

**Download ABCA4 FASTA Sequence:**

```bash
curl -o data_raw/sequences/ABCA4_P78363.fasta \
  https://rest.uniprot.org/uniprotkb/P78363.fasta
```

**References:**
- [ClinVar ABCA4](https://www.ncbi.nlm.nih.gov/clinvar/?term=ABCA4)
- [UniProt ABCA4](https://www.uniprot.org/uniprotkb/P78363)
- [Stargardt Disease Info](https://www.nei.nih.gov/learn-about-eye-health/eye-conditions-and-diseases/stargardt-disease)

## ğŸ“ Development Notes

- All scripts assume paths relative to this campaign folder
- Data directories (`data_raw/`, `data_processed/`) are git-ignored for size management
- Notebooks are stored as pure `.py` files (Git-friendly, reactive)
- Use `tasks.py` for reproducible pipeline automation
- Session state (`.marimo/`) is automatically managed and ignored
